Bootstrapper.bindDOMParsed(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;var consent=Bootstrapper.npg.utils.Consent;if(consent.allow(consent.TARGETING)){var images=document.images;var sendNielson=true;if(images.length>-1){var i=0;for(i;i<images.length;i++)if(images[i].src&&images[i].src.indexOf("secure-us.imrworldwide.com")>-1)sendNielson=false}if(sendNielson)(function(){var d=new Image(1,1);d.onerror=d.onload=function(){d.onerror=d.onload=null};
d.src=["//secure-us.imrworldwide.com/cgi-bin/m?ci\x3dus-504674h\x26cg\x3d0\x26cc\x3d1\x26si\x3d",escape(window.location.href),"\x26rp\x3d",escape(document.referrer),"\x26ts\x3dcompact\x26rnd\x3d",(new Date).getTime()].join("")})()}},2463291,136505);
Bootstrapper.bindDOMParsed(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;var consent=Bootstrapper.npg.utils.Consent;if(consent.allow(consent.TARGETING)){var c_id="14617931";var _comscore=window._comscore=_comscore||[];_comscore.push({c1:"2",c2:c_id});var protocol=document.location.protocol=="https:"?"https://sb":"http://b";Bootstrapper.insertScript(protocol+".scorecardresearch.com/beacon.js")}},2463378,541797);
Bootstrapper.bindImmediate(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;(function(){var d=document,f=d.getElementsByTagName("script")[0];s=d.createElement("script");s.type="text/javascript";s.async=true;s.src="//cdn.cookielaw.org/consent/792a5a21-3d99-4432-8f70-957d389bf2b9.js";f.parentNode.insertBefore(s,f)})();function OptanonWrapper(){}},2610719,517174);
Bootstrapper.bindImmediate(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;function splitKeys(targeting){var i;var j;var value=[];var valuesArray=[];var key;var prevKey="";var keyValue;var keyValuesArray=[];var splittedTargeting=targeting.split(";");for(i=0;i<splittedTargeting.length;++i){if(key!==undefined)prevKey=key;keyValue=splittedTargeting[i].split("\x3d");key=keyValue[0];if(key!==prevKey){if(prevKey.length>0&&valuesArray.length>0)keyValuesArray.push([prevKey,
valuesArray]);valuesArray=[]}if(keyValue.length===2&&keyValue[0]!==""&&keyValue[1]!==""){value=keyValue[1].split(",");for(j=0;j<value.length;++j)valuesArray.push(value[j])}}if(key.length>0&&valuesArray.length>0)keyValuesArray.push([key,valuesArray]);return keyValuesArray}function splitSizes(sizes){var i;var tmp;var height;var width;var sizeArray=[];var splittedSizes;if(sizes!==null){if(sizes.indexOf("|")!==-1)splittedSizes=sizes.split("|");else splittedSizes=sizes.split(",");for(i=0;i<splittedSizes.length;++i){tmp=
splittedSizes[i].split("x");width=parseInt(tmp[0],10);height=parseInt(tmp[1],10);if(tmp.length===2&&!isNaN(width)&&!isNaN(height)&&width>=0&&height>=0)sizeArray.push([width,height])}}return sizeArray}function hasClass(element,className){var i;var len;var elementClasses=element.className.split(/\s+/);for(i=0,len=elementClasses.length;i<len;++i)if(elementClasses[i]===className)return true;return false}function getAdContainers(){if(typeof document.getElementsByClassName==="function")return document.getElementsByClassName("div-gpt-ad");
else{var i;var containerDivs=[];var elements=document.getElementsByTagName("div");for(i=0;elements[i];++i)if(hasClass(elements[i],"div-gpt-ad"))containerDivs.push(elements[i]);return containerDivs}}function debounce(fn,threshold){var last=null;var timer=null;return function(){var context=this;var now=+new Date;var args=arguments;if(last&&now<last+threshold){clearTimeout(timer);timer=setTimeout(function(){last=now;fn.apply(context,args)},threshold)}else{last=now;fn.apply(context,args)}}}function addResizeEvent(fn){if(window.addEventListener)window.addEventListener("resize",
fn,false);else window.attachEvent("resize",fn)}function addScrollEvent(fn){if(window.addEventListener)window.addEventListener("scroll",fn,false);else window.attachEvent("onscroll",fn)}function removeScrollEvent(fn){if(window.removeEventListener)window.removeEventListener("scroll",fn,false);else window.detachEvent("scroll",fn)}function serveAdsFor(path){if(path.indexOf("/naturejobs")!==-1)return false;return true}function init(win,documentElement,Krux,accessData){var utils=Bootstrapper.npg.utils;var adSlots=
[];var slotsRemaining=[];var billboardSlot;var scrollListener=null;if(utils.Request.get("hide_ads")==="true")return;if(!serveAdsFor(win.location.pathname))return;var loadVisibleAds=function(adSlots){var height=Math.max(documentElement.clientHeight,win.innerHeight||0);return displayAdSlots(adSlots,function(slot){if(slot.isOutOfPage||slot.forceLoadOnInit)return true;var node=document.getElementById(slot.divId);var rect=node.getBoundingClientRect();var top=rect.top-300;return height>top})};var displayAdSlots=
function(slots,predicate){var n=slots.length;var adsToRefresh=[];while(n--)if(predicate(slots[n],n)){adsToRefresh.push(slots[n].slot);slots.splice(n,1)}if(adsToRefresh.length)googletag.pubads().refresh(adsToRefresh);return slots};var cleanTargetingParam=function(value){return value.replace(/^\s+/,"").replace(/\s+$/,"").replace(/\s+/g,"_").replace(/\W+/g,"")};var getTargeting=function(container){var krux=Krux.dfppKeyValues&&utils.Consent.allow(utils.Consent.TARGETING)?";"+Krux.dfppKeyValues:"";var test=
utils.Request.get("test");var ads=test&&test==="ads"?";adtype\x3dtest":"";var targeting=container.getAttribute("data-gpt-targeting");if(ads&&targeting.indexOf(ads)===-1)targeting+=ads;targeting+=accessData.registrant_id?";logged\x3dy":";logged\x3dn";if(accessData.business_partner_id)targeting+=";bpid\x3d"+accessData.business_partner_id.join(",");if(win.location.pathname.indexOf("/collections/")===0){var title=document.querySelector("span.hero-title-inner");if(title)targeting+=";sponsored\x3d"+cleanTargetingParam(title.innerText)}return targeting+
krux};var careerTypes={"career feature":true,"career news":true,"career q\x26a":true,"career brief":true,"career column":true,"spotlight":true,"career guide":true,"technology feature":true,"nature careers podcast":true};var isCareersListing=function(){if(/^\/nature\/articles\/?$/.test(window.location.pathname)){var type=(/^.*?(?:\?|&)type=([^&]+)/.exec(window.location.search)||["",""])[1];if(careerTypes[type.replace(/-/g," ").replace(/ and /,"\x26")])return true}return false};var isCareersArticle=
function(){if(window.dataLayer&&window.dataLayer.getPath)if(careerTypes[window.dataLayer.getPath("content.category.contentType")])return true;return false};var labanUnit3=function(path){if(path.indexOf("categ")!==-1)return"products";if(path.indexOf("supplier")!==-1)return"suppliers";return"homepage"};var adUnit2=function(){var pcode=win.dataLayer&&win.dataLayer.getPath?win.dataLayer.getPath("content.journal.pcode"):null;if(pcode)return pcode;if(win.location.hostname.indexOf("guide.labanimal")!==-1)return"laban/guide.labanimal/"+
labanUnit3(win.location.pathname);var path=win.location.pathname.replace(/^\/+/,"").split("/");var host=win.location.hostname.split(".").slice(1).join(".");return path.length&&path[0]!==""?path[0]:host};var unitPath=function(path){var dfpRoot="/270604982";if(path.indexOf("/")!==0)path="/"+path;if(path.indexOf("/285/")===0)path=path.replace(/^\/285\/[^\/]+/,dfpRoot+"/nature/"+adUnit2());path=path.replace("/nature/laban","/laban");path=path.replace("/nature/nature.com/index","/nature/nature/homepage");
path=path.replace("/collections/collections","/collections");path=path.replace("/search/search_results","/nature/search");path=path.replace(/\/article$/,"/articles");path=path.replace(/\/nature\/authors\/.*/,"/nature/nature/authors");if(win.location.hostname.indexOf("blogs")!==-1)path=path.replace(/\/nature\/.*/,"/nature/nature/blogs");if(win.location.hostname.indexOf("natureindex")!==-1){path=path.replace(/\/nature\/.*/,"/nature/nature_index");if(win.location.pathname==="/")path+="/homepage"}if(isCareersArticle())path=
path.replace(/\/articles$/,"/naturecareers");if(isCareersListing())path=path.replace(/\/article-list$/,"/naturecareers");var branded=document.querySelector('meta[name\x3d"brandedcontent"]');if(branded&&branded.getAttribute("content")==="true")path=dfpRoot+"/nature/brandedcontent";return path};var sizeToPosition={"728x90":{count:0,name:"LB"},"300x250":{count:0,name:"MPU"},"160x600":{count:0,name:"SKY"},"970x250":{count:0,name:"BB"},"2x2":{count:0,name:"NATIVE"},"300x100":{count:0,name:"REC"},"180x150":{count:0,
name:"EVENTS"},"120x60":{count:0,name:"TILE"}};var position=function(size){var info=sizeToPosition[size];if(info)return info.name+ ++info.count;return null};var injectTargeting=function(targeting,key,value){var added=false;for(var i=0;targeting[i];++i)if(targeting[i][0]===key&&value!==null){targeting[i][1]=[value];added=true}if(!added&&value!==null)targeting.push([key,[value]]);return targeting};var renameTargeting=function(targeting,oldKey,newKey){for(var i=0;targeting[i];++i)if(targeting[i][0]===
oldKey)targeting[i][0]=newKey;return targeting};var buildTargeting=function(adContainer,index){var withArticleId=renameTargeting(splitKeys(getTargeting(adContainer)),"artid","articleid");var withSearch=renameTargeting(withArticleId,"kw","search");var withPosition=injectTargeting(withSearch,"pos",position(adContainer.getAttribute("data-gpt-sizes")));var withTile=injectTargeting(withPosition,"tile",index+1);var withSubject=injectTargeting(withTile,"subject",function(chunks){if(chunks.length===3&&chunks[1]===
"subjects")return chunks[2];return null}(win.location.pathname.split("/")));var withCareers=injectTargeting(withSubject,"article",function(){return isCareersArticle()?"naturecareers":null}());return withCareers};var createAdSlots=function(adContainers){var adSlots=[];for(var i=0;adContainers[i];++i){var adContainer=adContainers[i];if(adContainer.className.indexOf("leaderboard")===-1||win.innerWidth>728)adSlots.push({divId:adContainer.getAttribute("id"),adUnitPath:unitPath(adContainer.getAttribute("data-gpt-unitpath")),
sizeArray:splitSizes(adContainer.getAttribute("data-gpt-sizes")),targeting:buildTargeting(adContainer,i),isOutOfPage:hasClass(adContainer,"out-of-page"),forceLoadOnInit:false,refreshed:false})}return adSlots};var configureAds=function(){googletag.cmd.push(function(){googletag.pubads().setRequestNonPersonalizedAds(utils.Consent.allow(utils.Consent.TARGETING)?0:1);googletag.pubads().disableInitialLoad();googletag.enableServices();googletag.pubads().addEventListener("slotRenderEnded",function(event){var slotId;
if(event.slot.o&&event.slot.o.m)slotId=event.slot.o.m;else if(event.slot.j&&event.slot.j.m)slotId=event.slot.j.m;else if(event.slot.l&&event.slot.l.m)slotId=event.slot.l.m;else slotId=null;var slot;if(slotId==="div-gpt-ad-billboard-2"&&event.isEmpty===false){slot=document.getElementById(slotId);slot.parentNode.parentNode.classList.add("pb40");slot.parentNode.parentNode.classList.remove("pb20");slot.parentNode.parentNode.classList.remove("hide")}if(slotId&&event.isEmpty){slot=document.getElementById(slotId);
slot.parentNode.parentNode.classList.remove("pb20");slot.parentNode.classList.remove("ad-with-label")}})});googletag.cmd.push(function(){for(var i=0;adSlots[i];++i)try{if(adSlots[i].isOutOfPage)adSlots[i].slot=googletag.defineOutOfPageSlot(adSlots[i].adUnitPath,adSlots[i].divId).addService(googletag.pubads());else adSlots[i].slot=googletag.defineSlot(adSlots[i].adUnitPath,adSlots[i].sizeArray,adSlots[i].divId).addService(googletag.pubads());for(var j=0,len=adSlots[i].targeting.length;j<len;++j)if(adSlots[i].targeting[j].length===
2&&adSlots[i].targeting[j][0]!==""&&adSlots[i].targeting[j][1]!==""){if(adSlots[i].targeting[j][0]==="pos"&&adSlots[i].targeting[j][1][0].indexOf("BB")===0){billboardSlot=adSlots[i].slot;var mapping=googletag.sizeMapping().addSize([970,250],[3,3]).addSize([770,100],[4,4]).addSize([0,0],[5,5]).build();billboardSlot.defineSizeMapping(mapping);billboardSlot.setCollapseEmptyDiv(true,true)}adSlots[i].slot.setTargeting(adSlots[i].targeting[j][0],adSlots[i].targeting[j][1])}}catch(e){console.log("failed to create slot for",
adSlots[i])}});googletag.cmd.push(function(){for(var i=0;adSlots[i];++i)googletag.display(adSlots[i].divId)})};var destroySlots=function(){googletag.destroySlots()};var loadSlots=function(){if(scrollListener)removeScrollEvent(scrollListener);googletag.cmd.push(function(){adSlots=loadVisibleAds(adSlots)});scrollListener=debounce(function(){googletag.cmd.push(function(){adSlots=loadVisibleAds(adSlots);if(!adSlots.length){removeScrollEvent(scrollListener);scrollListener=null}})},250);addScrollEvent(scrollListener)};
Bootstrapper.loadScriptCallback("//www.googletagservices.com/tag/js/gpt.js",function(){win.googletag=win.googletag||{};win.googletag.cmd=win.googletag.cmd||[];adSlots=createAdSlots(getAdContainers());configureAds();loadSlots();var desktop=win.innerWidth>969;var tablet=win.innerWidth>769&&!desktop;var mobile=win.innerWidth<770;var resizeListener=debounce(function(){var currentWidth=win.innerWidth;if(currentWidth>=970&&!desktop){desktop=true;tablet=false;mobile=false;googletag.cmd.push(function(){googletag.pubads().refresh([billboardSlot])})}else if(currentWidth<
770&&!mobile){desktop=false;tablet=false;mobile=true;googletag.cmd.push(function(){googletag.pubads().refresh([billboardSlot])})}else if(currentWidth<970&&currentWidth>769&&!tablet){desktop=false;tablet=true;mobile=false;googletag.cmd.push(function(){googletag.pubads().refresh([billboardSlot])})}},250);addResizeEvent(resizeListener);document.addEventListener("refreshads",function(){destroySlots();adSlots=createAdSlots(getAdContainers());configureAds();loadSlots()},false)})}document.addEventListener("accessdetailsloaded",
function(e){init(window,document.documentElement,window.Krux||{},e.detail||{})},false)},2664629,543213);