Bootstrapper.bindDOMParsed(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;(function(undefined){if(typeof window.CustomEvent==="function")return false;var CustomEvent=function(event,params){params=params||{};var evt=document.createEvent("CustomEvent");evt.initCustomEvent(event,params.bubbles||false,params.cancelable||false,params.detail||undefined);return evt};CustomEvent.prototype=window.Event.prototype;window.CustomEvent=CustomEvent})();var parse=
function(status,text){try{return status===200?JSON.parse(text):null}catch(e){return null}};var dispatch=function(data){var event=new CustomEvent("accessdetailsloaded",{detail:data});document.dispatchEvent(event)};var base=function(hostname){if(hostname.indexOf("www")===-1)return"https://www.nature.com";return""};if(window.location.hostname.indexOf(".nature.com")!==-1){var transport=new XMLHttpRequest;transport.open("GET",base(window.location.hostname)+"/platform/login/details",true);transport.onreadystatechange=
function(){if(transport.readyState===4)dispatch(parse(transport.status,transport.responseText))};transport.send()}else dispatch(null)},2474870,534263);
Bootstrapper.bindImmediate(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;var i=window,r="ga";i.GoogleAnalyticsObject=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)};i[r].l=1*new Date;(function(win,doc,undefined){win._pageMetaData=win._pageMetaData||{};win.dataLayer=win.dataLayer||[];var slice=Array.prototype.slice;var push=Array.prototype.push;var dimensionsCache={};doc.addEventListener("accessdetailsloaded",function(e){var data=
e.detail;var update={event:"update-access-details"};if(data){var ri=data.registrant_id||"";var si=data.site_id&&data.site_id.join?data.site_id.join(";"):"";var bp=data.business_partner_id&&data.business_partner_id.join?data.business_partner_id.join(";"):"";update.user={};update.user.profile={};update.user.profile.profileInfo={profileID:ri||null,bpid:bp||null};update.user.segment={registeredUser:!!ri};update.session={};update.session.authentication={};update.session.authentication.token=data.token||
null;update.session.authentication.legacy={};update.session.authentication.legacy.webtrendsSiteID=si||null}win.dataLayer.push(update);setTimeout(function(){var consent=Bootstrapper.npg.utils.Consent;if(consent.allow(consent.PERFORMANCE))init()},200)},false);var isArray=function(obj){return!!obj&&Array===obj.constructor};var isObject=function(obj){return typeof obj==="object"&&obj!==null};var map=function(arr,fn){var acc=[];if(isArray(arr)){var n=arr.length;for(var i=0;i<n;++i)acc.push(fn(arr[i]))}return acc};
var closestByAttribute=function(node,attr,value){return closest(node,function(node){return node.hasAttribute&&node.hasAttribute(attr)&&(typeof value==="undefined"||node.getAttribute(attr)===value)})};var closest=function(node,matcher){do{if(matcher(node))return node;node=node.parentNode}while(node)};var enforceDataType=function(data,type){if(type==="array")if(isArray(data)===true)return data;if(typeof data===type)return data;return null};var lc=function(value){return typeof value==="string"?value.toLowerCase():
value};var normaliseAnd=function(value){return typeof value==="string"?value.replace(/&(?![#a-z0-9]+?;)/g,"and").replace("\x26amp;","and"):value};var normaliseWhitespace=function(value){return typeof value==="string"?value.replace(/^\s+/,"").replace(/\s+$/,"").replace(/\s+/," "):value};var formatDate=function(value){return typeof value==="string"?value.split("/").join("-"):value};var populateDimensions=function(filter){var dimensions={contentGroup2:function(){return lc(extract.pageType())},contentGroup3:function(){return normaliseWhitespace(normaliseAnd(lc(extract.contentType())))},
dimension3:function(){return extract.scihub()},dimension4:function(){return extract.deliveryPlatform()},dimension5:function(){return normaliseWhitespace(normaliseAnd(lc(extract.journalTitle())))},dimension6:function(){return extract.doi()},dimension8:function(){return formatDate(extract.publicationDate())},dimension9:function(){return extract.publicationTimestamp()},dimension10:function(){return extract.issue()},dimension11:function(){return extract.volume()},dimension12:function(){return extract.auth()},
dimension13:function(){return extract.webtrendsSiteId()},dimension14:function(){return extract.userId()},dimension16:function(){return extract.webtrendsLicenceType()},dimension17:function(){return lc(extract.webtrendsContentCategory())},dimension18:function(){return lc(extract.webtrendsContentCollection())},dimension19:function(){return normaliseWhitespace(normaliseAnd(lc(extract.webtrendsContentGroup())))},dimension20:function(){return lc(extract.webtrendsContentSubGroup())},dimension21:function(){return lc(extract.webtrendsPrimaryArticleType())},
dimension22:function(){return lc(extract.webtrendsSubjectTerms())},dimension23:function(){return extract.cms()},dimension25:function(){return extract.authors()},dimension26:function(){return lc(extract.pageTitle())},dimension27:function(){return extract.template()},dimension28:function(){return extract.version()},dimension30:function(){return normaliseWhitespace(extract.searchQuery())},dimension60:function(){return normaliseWhitespace(normaliseAnd(lc(extract.contentType())))},dimension61:function(){return extract.businessPartnerId()},
dimension63:function(){return extract.featureFlags()},dimension64:function(){return extract.sessionToken()},dimension72:function(){return extract.pageFeatures()}};var newValue;var updated=false;var wantsUpdate=function(name){return!filter||filter[name]};for(var prop in dimensions)if(dimensions.hasOwnProperty(prop)&&wantsUpdate(prop)){newValue=dimensions[prop]();if(dimensionsCache[prop]!==newValue){win.ga("set",prop,newValue||"(not set)");dimensionsCache[prop]=newValue;updated=true}}return updated};
var extract={schema:function(){if(JSON.parse&&doc.querySelector){var data=doc.querySelector('script[type\x3d"application/ld+json"]');return data?JSON.parse(data.textContent):null}return null},pageType:function(){var dl=win.dataLayer.getPath("page.category.pageType");if(dl)return dl;if(doc.querySelector){var tag=doc.querySelector('meta[property\x3d"og:type"]');return tag?tag.getAttribute("content"):null}return null},scihub:function(){if(doc.querySelectorAll)return!!doc.querySelectorAll('a[href*\x3d"sci-hub"]').length;
return null},contentType:function(){return win.dataLayer.getPath("content.category.contentType")||win._pageMetaData["WT.cg_s"]||null},deliveryPlatform:function(){return win.dataLayer.getPath("content.attributes.deliveryPlatform")||(schemaData?"aws":null)},journalTitle:function(){return win.dataLayer.getPath("content.journal.title")||win._pageMetaData.citation_title||null},doi:function(){var dl=win.dataLayer.getPath("content.article.doi");if(dl)return dl;if(win._pageMetaData.citation_doi&&typeof win._pageMetaData.citation_doi===
"string")return win._pageMetaData.citation_doi.replace(/^doi:/,"");return null},publicationDate:function(){return win.dataLayer.getPath("content.contentInfo.publishedAtString")||win._pageMetaData.citation_date||null},publicationTimestamp:function(){var dl=win.dataLayer.getPath("content.contentInfo.publishedAt");if(dl)return dl;try{var ts=(new Date(win._pageMetaData.citation_date)).getTime();return ts&&!isNaN(ts)?ts:null}catch(e){return null}},issue:function(){return win.dataLayer.getPath("content.journal.issue")||
win._pageMetaData.citation_issue||null},volume:function(){return win.dataLayer.getPath("content.journal.volume")||win._pageMetaData.citation_volume||null},auth:function(){return win.dataLayer.getPath("content.authorization.status")},webtrendsSiteId:function(){return win.dataLayer.getPath("session.authentication.legacy.webtrendsSiteID")||win._pageMetaData.site_id||null},webtrendsLicenceType:function(){return win.dataLayer.getPath("content.attributes.copyright.legacy.webtrendsLicenceType")},webtrendsContentCategory:function(){return win.dataLayer.getPath("content.attributes.copyright.legacy.webtrendsContentCategory")},
webtrendsContentCollection:function(){return win.dataLayer.getPath("content.attributes.copyright.legacy.webtrendsContentCollection")},webtrendsContentGroup:function(){return win.dataLayer.getPath("content.category.legacy.webtrendsContentGroup")||win._pageMetaData.product_name||win._pageMetaData.citation_journal_title||null},webtrendsContentSubGroup:function(){return win.dataLayer.getPath("content.category.legacy.webtrendsContentSubGroup")||win._pageMetaData["WT.cg_s"]||null},webtrendsPrimaryArticleType:function(){return win.dataLayer.getPath("content.category.legacy.webtrendsPrimaryArticleType")},
webtrendsSubjectTerms:function(){return win.dataLayer.getPath("content.category.legacy.webtrendsSubjectTerms")},cms:function(){return win.dataLayer.getPath("content.attributes.cms")||(schemaData?"polopoly":null)},authors:function(){return(win.dataLayer.getPath("content.contentInfo.authors")||[]).join(";")||win._pageMetaData.citation_authors||null},pageTitle:function(){return win.dataLayer.getPath("content.contentInfo.title")||win._pageMetaData.citation_title||null},template:function(){return win.dataLayer.getPath("page.attributes.template")},
version:function(){return win.dataLayer.getPath("version")},userId:function(){return win.dataLayer.getPath("user.profile.profileInfo.profileID")},businessPartnerId:function(){return win.dataLayer.getPath("user.profile.profileInfo.bpid")},sessionToken:function(){return win.dataLayer.getPath("session.authentication.token")},searchQuery:function(){return win.dataLayer.getPath("page.search.keywords")},featureFlags:function(){var flags=win.dataLayer.getPath("page.attributes.featureFlags")||[];return map(flags,
function(flag){if(typeof flag==="string")return flag+"\x3dtrue";if(flag.name)return[flag.name,!!flag.active].join("\x3d");return""}).join(";")},pageFeatures:function(){var features=win.dataLayer.getPath("content.features")||[];return map(features,function(feature){if(feature.name)return[feature.name,!!feature.present].join("\x3d");return""}).join(";")}};Object.defineProperty(win.dataLayer,"push",{configurable:false,enumerable:false,writable:false,value:function(){var args=slice.call(arguments,0);
var result=push.apply(this,args);populateDimensions();return result}});Object.defineProperty(window.dataLayer,"getPath",{configurable:false,enumerable:false,writable:false,value:function(){var check=function(obj,keys){var key=keys[0];if(keys.length>1)return isObject(obj)?check(obj[key],keys.slice(1)):undefined;return isObject(obj)?obj[key]:undefined};var get=function(){return isObject(this)?check(this,slice.call(arguments,0)):undefined};var args=slice.call(arguments,0);args=args.length===1?args[0].split("."):
args;var result;for(var i=0;this[i];++i){var next=get.apply(this,[i].concat(args));if(next!==undefined)result=next}return result}});var createEventPayload=function(node,eventType){var external=function(link){return window.location.hostname!==link.hostname};var defaultCategory=function(){var parent=closestByAttribute(node,"data-track-component");if(parent)return parent.getAttribute("data-track-component");var template=win.dataLayer.getPath("page.attributes.template");var pageType=win.dataLayer.getPath("page.category.pageType");
if(template&&pageType)return template+":"+pageType;return template||pageType||""};var defaultAction=function(){var parent=closestByAttribute(node,"data-track-component");if(parent)return parent.getAttribute("data-track-component")+":"+eventType;return eventType};var defaultLabel=function(){if(node.href&&external(node))return node.href;return null};var payload={action:node.getAttribute("data-track-action")||defaultAction(),category:node.getAttribute("data-track-category")||defaultCategory(),label:node.getAttribute("data-track-label")||
defaultLabel()};return payload.label?payload:null};var createEcommercePromotionEvent=function(node){var index=parseInt(node.getAttribute("data-track-promotion"),10);var promotions=win.dataLayer.getPath("promotion");if(!isNaN(index)&&enforceDataType(promotions,"array")&&promotions.length>index){var promotion=promotions[index];return{id:enforceDataType(promotion.promotionInfo.promotionID,"string"),name:enforceDataType(promotion.promotionInfo.promotionName,"string"),position:"slot"+index}}};var createEcommerceProductEvent=
function(node){var index=parseInt(node.getAttribute("data-track-product"),10);return productAtIndex(win.dataLayer.getPath("product"),index)};var productAtIndex=function(products,index){if(!isNaN(index)&&enforceDataType(products,"array")&&products.length>index){var product=products[index];return{id:enforceDataType(product.productInfo.sku,"string"),name:enforceDataType(product.productInfo.productName,"string"),brand:enforceDataType(product.productInfo.brand,"string"),variant:enforceDataType(product.category.productType,
"string"),price:enforceDataType(product.price.basePrice,"number").toString(),position:"slot"+index}}};var sendActiveFeatureFlags=function(flags){var abTestPattern=/^ab_?test/i;if(flags&&flags.length)for(var i=0;flags[i];++i)if(typeof flags[i]==="string"&&flags[i].match(abTestPattern))sendEvent({action:"Active Feature",category:"Feature Flag",label:flags[i],nonInteraction:true});else if(flags[i].active&&flags[i].name&&flags[i].name.match(abTestPattern))sendEvent({action:"Active Feature",category:"Feature Flag",
label:flags[i].name,nonInteraction:true})};var sendEvent=function(payload){var event={hitType:"event",eventAction:payload.action,eventCategory:payload.category,eventLabel:payload.label};if(payload.value)event.eventValue=payload.value;if(payload.nonInteraction)event.nonInteraction=payload.nonInteraction;win.ga("send","event",event)};var eventHandler=function(node,type){var target=closestByAttribute(node,"data-track",type);var payload=null;if(target){payload=createEventPayload(target,type);if(payload)sendEvent(payload)}};
var schemaData=extract.schema();Bootstrapper.insertScript("//www.google-analytics.com/analytics.js");Bootstrapper.UA_ga=Bootstrapper.UA_ga||{};win.ga("create","UA-71668177-1","auto");win.ga("require","linkid","linkid.js");win.ga("require","ec");var init=function(){win.ga("send","pageview",Bootstrapper.UA_ga||{});sendActiveFeatureFlags(win.dataLayer.getPath("page.attributes.featureFlags"));(function(products){if(products&&products.length){for(var i=0;products[i];++i){var product=productAtIndex(products,
i);product.list="Search Results";win.ga("ec:addImpression",product)}sendEvent({action:"impression",category:"catalog",nonInteraction:true})}})(win.dataLayer.getPath("product"));Bootstrapper.on("click",'[data-track\x3d"click"]',function(e){eventHandler(e.target,"click")});Bootstrapper.on("change",'[data-track\x3d"change"]',function(e){eventHandler(e.target,"change")});Bootstrapper.on("click",'[data-track\x3d"download"]',function(e){eventHandler(e.target,"download")});Bootstrapper.on("submit",'form[data-track\x3d"submit"]',
function(e){eventHandler(e.target,"submit")});Bootstrapper.on("submit",'form[data-component\x3d"search-form"]',function(){populateDimensions({dimension30:true})});Bootstrapper.on("change",'form[data-track-action\x3d"search-body"] select',function(e){var target=e.target;var form=closest(target,function(node){return lc(node.nodeName)==="form"});var subject=target.options[target.selectedIndex].value;var label=subject?"search-body-"+subject:"search-body";form.setAttribute("data-track-label",label)});
Bootstrapper.on("click",'[data-track\x3d"click-promotion"]',function(e){var target=closestByAttribute(e.target,"data-track","click-promotion");var payload=null;if(target){payload=createEcommercePromotionEvent(target);if(payload){win.ga("ec:addPromo",payload);win.ga("ec:setAction","promo_click");sendEvent({category:"Internal Promotions",action:"click",label:payload.name})}}});Bootstrapper.on("click",'[data-track\x3d"click-product"]',function(e){var target=closestByAttribute(e.target,"data-track","click-product");
var payload=null;if(target){payload=createEcommerceProductEvent(target);if(payload){win.ga("ec:addProduct",payload);win.ga("ec:setAction","click",{list:"Search Results"});sendEvent({category:"UX",action:"click",label:"Results",value:payload.name})}}});Bootstrapper.on("click",'a[href*\x3d"sci-hub"],a[href*\x3d"dx.doi.org"]',function(e){sendEvent({action:"Click Event",category:"External Link",label:this.href.indexOf("sci-hub")!==-1?"sci-hub":"dx.doi.org"})})}})(window,document)},2673034,534288);
Bootstrapper.bindDOMParsed(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;var consent=Bootstrapper.npg.utils.Consent;var endDate=new Date("2019-02-31");var today=new Date;var host=window.location.hostname.toLowerCase();if(endDate>today&&consent.allow(consent.TARGETING)&&!host.match(/^.*press\.nature\.com$/)){var _kiq=_kiq||[];(function(){var d=document,f=d.getElementsByTagName("script")[0],s=d.createElement("script");s.type="text/javascript";
s.async=true;s.src="//s3.amazonaws.com/ki.js/47412/e2T.js";f.parentNode.insertBefore(s,f)})()}},2622032,363828);