(function(){this.MobileRegPath||(this.MobileRegPath={}),this.MobileRegPath.notifier=new c.Server.Notification("msutd"),this.MobileRegPath.notifier.notifyAndLog=function(t,e){return null==e&&(e={}),$a.log(t),this.notify({event_type:t,location:null!=e.location?e.location:void 0,attachment_id:null!=e.attachment_id?e.attachment_id:void 0,auvid:$auvid})}}).call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/layout"]=function(t){var e=[],i=t||{};return function(t){e.push('<div id="mobile_reg_path" class="DesignSystem"><div class="full-screen-modal-header u-pv4x u-taCenter"><img'+jade.attr("src",""+t("academia-logo-redesign-2015.svg"),!0,!1)+jade.attr("onerror","this.onerror=null;this.src="+t("academia-logo-redesign-2015.png"),!0,!1)+' class="swp-mobile-signup-modal-header-logo"/><span class="swp-mobile-signup-modal-header-close u-positionAbsolute js-sent-email-finished u-clickable u-fs18 u-tcGrayDark">&times;</span></div><div class="container-fluid"><div class="row"><div class="col-xs-12"><div class="full-screen-modal-page-header u-taCenter u-mv4x"><span class="modal-page-header js-modal-page-header u-fs16"></span></div></div><div class="col-xs-12"><div class="full-screen-modal-page-content u-p0x"></div></div></div></div></div>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:undefined),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/pages/enter_email_page"]=function(t){var e=[],i=t||{};return function(t){e.push('<div class="u-displayFlex u-flexColumn u-alignItemsCenter u-mv4x"><button id="google-signup-button" style="height:46px; width: 250px; padding:0 12px" class="Button Button--google u-mb4x u-mr4x"><img style="top:0px;left:0px;border-radius:1px" height="44" width="44"'+jade.attr("src",t("google/google-color.svg"),!0,!1)+' class="u-positionAbsolute"/><span style="text-transform:none;letter-spacing:0.2px;margin-left:40px;margin-right:-4px" class="u-fs14 u-fw400">Download with Google</span></button><button id="fb-signup-button" style="height:46px; width: 250px; padding:0 12px" class="Button Button--facebook u-mb4x u-mr4x"><img style="top:0px;left:0px;border-radius:1px" height="44" width="44"'+jade.attr("src",t("facebook/facebook-color.svg"),!0,!1)+' class="u-positionAbsolute"/><span style="text-transform:none;letter-spacing:0.2px;margin-left:40px;margin-right:-4px" class="u-fs14 u-fw400">Download with Facebook</span></button></div><div class="hr-heading login-hr-heading u-mb4x"><span class="hr-heading-text">or</span></div><form class="js-mobile-signup-modal-email-form"><div class="u-displayFlex u-flexColumn u-alignItemsCenter"><div class="u-mb4x u-fs16">Enter your email address</div><input type="email" placeholder="Email" class="js-email TextInput"/><input type="submit" disabled="disabled" value="Submit" class="u-mt3x js-submit-email Button Button--block Button--disabled"/></div></form>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:undefined),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/pages/enter_name_page"]=function(){var t=[];return t.push('<form onsubmit="return false" class="js-mobile-signup-modal-final-form"><input type="text" placeholder="First Name" id="user_first_name" autocomplete="given-name" class="TextInput js-first-name"/><div class="u-mt3x"><input type="text" placeholder="Last Name" id="user_last_name" autocomplete="family-name" class="TextInput js-last-name"/></div><div class="u-mt3x"><input type="password" placeholder="Password" id="user_password" autocomplete="new-password" class="TextInput js-password"/></div><div class="u-mt3x"><input type="submit" disabled="disabled" value="Submit" class="js-submit-name Button Button--block Button--green"/></div></form>'),t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/pages/sent_email_page_app_upsell"]=function(t){var e=[],i=t||{};return function(t){e.push('<meta name="viewport" content="width=device-width, user-scalable=no"/><img style="position: absolute; width: 113px; top: -16px; right: 21px"'+jade.attr("src",t("sutd_app_store/paper-top-right@3x.png"),!0,!1)+'/><img style="position: absolute; height: 141px; top: 20px; left: 0px"'+jade.attr("src",t("sutd_app_store/paper-top-left@3x.png"),!0,!1)+'/><img style="position: absolute; height: 141px; top: 105px; right: 0px"'+jade.attr("src",t("sutd_app_store/paper-middle-right@3x.png"),!0,!1)+'/><img style="position: absolute; height: 141px; bottom:45px; left: 0px"'+jade.attr("src",t("sutd_app_store/paper-bottom-left@3x.png"),!0,!1)+'/><img style="position: absolute; height: 141px; bottom:30px; right: 0px"'+jade.attr("src",t("sutd_app_store/paper-bottom-right@3x.png"),!0,!1)+'/><div class="u-taCenter u-mt20x u-pt13x"><img style="width: 96px"'+jade.attr("src",t("sutd_app_store/app-store-icon-sutd@3x.png"),!0,!1)+'/></div><div class="u-taCenter u-mt1x u-fs24 u-lineHeight1_2">Welcome to Academia.edu</div><div class="u-taCenter u-fs16 u-tcBlack u-mt3x u-lineHeight1_2">Read your paper - and thousands of related papers - in our free iOS app.</div><div class="u-taCenter"><a href="https://academia.app.link/Cyr4YDnAA1"><input type="submit" value="Get the app" style="height: 56px; width: 90%;  backgroundColor: #0954D3; borderRadius: 14px;" class="u-fs16 u-mt4x Button Button--blue"/></a></div><div class="u-taCenter u-mt20x u-pt20x"><div style="cursor: pointer" class="u-tcGrayDark js-sent-email-finished">We\'ve also emailed a PDF copy of the paper to you. Click here to read and download your paper online.</div></div>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:undefined),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/pages/sent_email_page_default"]=function(t){var e=[],i=t||{};return function(t){e.push('<div class="u-taCenter u-mb1x u-mt3x u-fs24 u-lineHeight1_2">Welcome to Academia.edu</div><div class="u-taCenter u-fs16 u-tcGrayDarker">We\'ve emailed you a copy of your paper.</div><div class="u-taCenter u-mt5x"><img style="width: 70%"'+jade.attr("src",t("sent_email_hero.svg"),!0,!1)+'/></div><div class="u-taCenter"><input type="submit" value="Continue Reading" class="u-mt3x js-sent-email-finished Button Button--blue"/></div>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:undefined),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/pages/social_auth_app_upsell"]=function(t){var e=[],i=t||{};return function(t){e.push('<div id="mobile_reg_path" class="DesignSystem"><div class="full-screen-modal-header u-pv4x u-taCenter"><img'+jade.attr("src",""+t("academia-logo-redesign-2015.svg"),!0,!1)+jade.attr("onerror","this.onerror=null;this.src="+t("academia-logo-redesign-2015.png"),!0,!1)+' class="swp-mobile-signup-modal-header-logo"/><span class="swp-mobile-signup-modal-header-close u-positionAbsolute close-popup u-clickable u-fs18 u-tcGrayDark">&times;</span></div><div class="u-p4x"><img style="position: absolute; width: 113px; top: 53px; right: 21px"'+jade.attr("src",t("sutd_app_store/paper-top-right@3x.png"),!0,!1)+'/><img style="position: absolute; height: 141px; top: 89px; left: 0px"'+jade.attr("src",t("sutd_app_store/paper-top-left@3x.png"),!0,!1)+'/><img style="position: absolute; height: 141px; top: 174px; right: 0px"'+jade.attr("src",t("sutd_app_store/paper-middle-right@3x.png"),!0,!1)+'/><img style="position: absolute; height: 141px; bottom:45px; left: 0px"'+jade.attr("src",t("sutd_app_store/paper-bottom-left@3x.png"),!0,!1)+'/><img style="position: absolute; height: 141px; bottom:30px; right: 0px"'+jade.attr("src",t("sutd_app_store/paper-bottom-right@3x.png"),!0,!1)+'/><div class="u-taCenter u-mt20x u-pt13x"><img style="width: 96px"'+jade.attr("src",t("sutd_app_store/app-store-icon-sutd@3x.png"),!0,!1)+'/></div><div class="u-taCenter u-mt1x u-fs24 u-lineHeight1_2">Welcome to Academia.edu</div><div class="u-taCenter u-fs16 u-tcBlack u-mt3x u-lineHeight1_2">Read your paper - and thousands of related papers - in our free iOS app.</div><div class="u-taCenter"><a href="https://academia.app.link/BjsQZnTzA1"><input type="submit" value="Get the app" style="height: 56px; width: 90%;  backgroundColor: #0954D3; borderRadius: 14px;" class="u-fs16 u-mt4x Button Button--blue"/></a></div><div class="u-taCenter u-mt20x u-pt20x"><div style="cursor: pointer" class="u-tcGrayDark close-popup">Or click here to read your paper online.</div></div></div></div>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:undefined),e.join("")}}.call(this),function(){this.MobileRegPath.Layout=Backbone.View.extend({template:"mobile_reg_path/templates/layout",events:{"click .js-sent-email-finished":function(){return this.closeMobileRegPath(!1)}},initialize:function(t){return this.container=$("#full-screen-modal").css("background-color","#fff"),this.attachment_id=t.attachment_id,this.model=new MobileRegPath.newUser({attachment_id:this.attachment_id,user_source:"mobile_download"}),this.recaptchaToSignup=t.recaptchaToSignup,this.ios_user=t.ios_user,this.container.html(this.render().el),this.container.fadeIn()},render:function(){return this.$el.html(JST[this.template]()),this.postRender(),this.$(".js-sent-email-finished").click(function(){return function(t){return t.preventDefault(),t.stopPropagation(),window.location.reload()}}()),this},postRender:function(){return this.ui={$headerText:this.$(".js-modal-page-header"),$pageContent:this.$(".full-screen-modal-page-content")},this.initializePageManager()},resetModel:function(){return this.model=new MobileRegPath.NewUser({attachment_id:this.attachment_id,user_source:"mobile_download"})},closeMobileRegPath:function(t){return null==t&&(t=!0),t&&MobileRegPath.notifier.notifyAndLog("download_closed",{attachment_id:this.attachment_id,location:this.pageManager.currentView.el.id}),this.container.fadeOut(),this.container.html(""),MobileRegPath.close=!1,$(".js-swp-mobile-get-pdf-footer").removeClass("u-displayNone")},steps:function(){return[{viewClass:MobileRegPath.EnterEmailPage,options:{model:this.model}},{viewClass:MobileRegPath.EnterNamePage,shouldSkip:function(t){return function(){return t.skipNamePage()}}(this),options:{model:this.model,recaptchaToSignup:this.recaptchaToSignup}},{viewClass:MobileRegPath.SentEmailPageDefault,shouldSkip:function(t){return function(){return t.ios_user}}(this),options:{model:this.model}},{viewClass:MobileRegPath.SentEmailPageAppUpsell,shouldSkip:function(t){return function(){return!t.ios_user}}(this),options:{model:this.model}}]},initializePageManager:function(){return this.pageManager=new Aedu.RegPath.PageManagerView({el:this.ui.$pageContent,steps:this.steps(),headerText:this.ui.$headerText})},skipNamePage:function(){return MobileRegPath.user_exists}})}.call(this),function(){this.MobileRegPath.AppStorePopupSocialAuth=Backbone.View.extend({id:"app-store-popup-social-auth",headerText:" ",template:"mobile_reg_path/templates/pages/social_auth_app_upsell",events:{"click .close-popup":"closePopup"},initialize:function(){return this.container=$("#full-screen-modal").css("background-color","#fff"),this.container.html(this.render().el),this.container.fadeIn()},render:function(){return this.$el.html(JST[this.template]()),this},closePopup:function(){return this.container.fadeOut(),this.container.html("")}})}.call(this),function(){this.MobileRegPath.EnterEmailPage=Backbone.View.extend({id:"email-page",stepNumber:1,template:"mobile_reg_path/templates/pages/enter_email_page",events:{"submit .js-mobile-signup-modal-email-form":"submitEmail","change input.js-email":"toggleSubmitButton","keydown input.js-email":"toggleSubmitButton","keyup input.js-email":"toggleSubmitButton","keydown input.js-email":"logEmailTyping"},initialize:function(){return this.sentLog=!1,this.render()},render:function(){return this.$el.html(JST[this.template]()),this.postRender()},postRender:function(){var t;return this.ui={$email:this.$(".js-email"),$submit:this.$(".js-submit-email"),$googleButton:this.$("#google-signup-button"),$facebookButton:this.$("#fb-signup-button")},t=window.location.href+(window.location.search?"&":"?")+"show_app_store_popup=true",new Aedu.Auth.OauthButton.Connect.Google({el:this.ui.$googleButton,track:!0,registrationParams:{user_source:"mobile_download_social",doc_id:this.model.get("attachment_id"),successRedirectUrl:t}}),new Aedu.Auth.OauthButton.Connect.Facebook({el:this.ui.$facebookButton,track:!0,registrationParams:{user_source:"mobile_download_social",doc_id:this.model.get("attachment_id"),successRedirectUrl:t}}),this.ui.$email.focus()},checkEmail:function(){return $.ajax({type:"POST",url:$r.partial_create_registrations_path(),data:{partial_registration:{email:this.model.get("email"),attachment_id:this.model.get("attachment_id")}}})},saveEmail:function(){return this.model.set({email:this.ui.$email.val()})},submitEmail:function(t){return t.preventDefault(),MobileRegPath.notifier.notifyAndLog("attempted_submit_email"),this.saveEmail(),this.checkEmail().done(function(t){return function(e){return e.email_invalid===!0?(alert("Please enter a valid email"),MobileRegPath.notifier.notifyAndLog("validation_failure",{attachment_id:t.model.get("attachment_id"),error:"email_invalid"})):e.user_exists===!0?(MobileRegPath.notifier.notifyAndLog("email_valid",{attachment_id:t.model.get("attachment_id"),location:"existing_user"}),MobileRegPath.user_exists=!0,t.trigger("step_complete")):(MobileRegPath.notifier.notifyAndLog("email_valid",{attachment_id:t.model.get("attachment_id"),location:"new_user"}),MobileRegPath.user_exists=!1,t.trigger("step_complete"))}}(this)).fail(function(){return alert("Something went wrong")})},disableSubmitButton:function(){return this.ui.$submit.attr("disabled",!0).removeClass("Button--green").addClass("Button--disabled")},enableSubmitButton:function(){return this.ui.$submit.removeAttr("disabled").removeClass("Button--disabled").addClass("Button--green")},toggleSubmitButton:function(){return this.ui.$email.val().length>0?this.enableSubmitButton():this.disableSubmitButton()},logEmailTyping:function(){return this.sentLog||MobileRegPath.notifier.notifyAndLog("started_typing",{attachment_id:this.model.get("attachment_id"),location:"user_email"}),this.sentLog=!0}})}.call(this),function(){this.MobileRegPath.EnterNamePage=Backbone.View.extend({id:"name-page",stepNumber:2,headerText:"Enter your name and password",template:"mobile_reg_path/templates/pages/enter_name_page",events:{"change input":"toggleSubmitButtonAndLog","keydown input":"toggleSubmitButtonAndLog","keyup input":"toggleSubmitButtonAndLog"},initialize:function(t){return this.log={user_first_name:!1,user_last_name:!1,user_password:!1},this.recaptchaToSignup=t.recaptchaToSignup,this.model=t.model,this.render()},render:function(){return this.$el.html(JST[this.template](this.model.attributes)),this.postRender(),this},postRender:function(){return this.ui={$password:this.$(".js-password"),$submit:this.$(".js-submit-name"),$first_name:this.$(".js-first-name"),$last_name:this.$(".js-last-name")},this.ui.$first_name.focus(),this.recaptchaToSignup?Aedu.a_recaptcha.load().then(function(t){return function(){return Aedu.a_recaptcha.register(t.$(".js-submit-name")[0],function(e){return t.toNextPage(e)}),Aedu.a_recaptcha.moveBadgeWhenVisible(t.$(".js-submit-name")[0],document.body)}}(this)):this.$(".js-mobile-signup-modal-final-form").submit(function(t){return function(){return t.toNextPage()}}(this))},saveFields:function(){return this.model.set({password:this.ui.$password.val(),first_name:this.ui.$first_name.val(),last_name:this.ui.$last_name.val()})},generateErrorMessages:function(t){var e;return 0===t.length?"Something went wrong":(e=[],t.forEach(function(t){if("user[display_name]"!==t[0])return e.push(t[1])}),e.join("\n"))},toNextPage:function(t){return MobileRegPath.notifier.notifyAndLog("attempted_submit"),this.saveFields(),this.model.save(t).done(function(t){return function(e){var i,a,s;return s=e[0],i=e[1],a=e[2],s?(window.$current_user=JSON.parse(i.user),Aedu.User.set_current($current_user),MobileRegPath.user_confirmed=!Aedu.User.current.unconfirmed,t.trigger("step_complete")):(MobileRegPath.notifier.notifyAndLog("validation_failure",{error:JSON.stringify(a)}),alert(t.generateErrorMessages(a)),t.recaptchaToSignup?Aedu.a_recaptcha.reset(t.$(".js-submit-name")[0]):void 0)}}(this)).fail(function(){return alert("Something went wrong")})},disableSubmitButton:function(){return this.ui.$submit.attr("disabled",!0).removeClass("Button--green").addClass("Button--disabled")},enableSubmitButton:function(){return this.ui.$submit.removeAttr("disabled").removeClass("Button--disabled").addClass("Button--green")},toggleSubmitButtonAndLog:function(t){if(this.ui.$password.val().length>0&&this.ui.$first_name.val().length>0&&this.ui.$last_name.val().length>0?this.enableSubmitButton():this.disableSubmitButton(),!this.log[t.target.id])return MobileRegPath.notifier.notifyAndLog("started_typing",{location:t.target.id}),this.log[t.target.id]=!0}})}.call(this),function(){this.MobileRegPath.SentEmailPageAppUpsell=Backbone.View.extend({id:"sent-email-page-app-upsell",stepNumber:4,headerText:" ",template:"mobile_reg_path/templates/pages/sent_email_page_app_upsell",initialize:function(){return this.render()},render:function(){return this.$el.html(JST[this.template]()),this.$(".js-sent-email-finished").click(function(){return function(t){return t.preventDefault(),t.stopPropagation(),window.location.reload()}}()),this}})}.call(this),function(){this.MobileRegPath.SentEmailPageDefault=Backbone.View.extend({id:"sent-email-page-default",stepNumber:3,headerText:" ",template:"mobile_reg_path/templates/pages/sent_email_page_default",initialize:function(){return this.render()},render:function(){return this.$el.html(JST[this.template]()),this.$(".js-sent-email-finished").click(function(){return function(t){return t.preventDefault(),t.stopPropagation(),window.location.reload()}}()),this}})}.call(this),function(){this.MobileRegPath.newUser=Backbone.Model.extend({save:function(t){return this.savingToServer?$.Deferred():(this.savingToServer=!0,$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:$r.registrations_path(),data:this.dataForSave({"g-recaptcha-response":t}),complete:function(t){return function(){return t.savingToServer=!1}}(this)}))},dataForSave:function(t){var e,i,a;e={user:{email:this.get("email"),first_name:this.get("first_name"),last_name:this.get("last_name"),password:this.get("password")},doc_id:this.get("attachment_id"),user_source:this.get("user_source"),splash:this.get("splash"),login_redirect:this.get("login_redirect"),user_occupation:this.get("user_occupation")};for(i in t)a=t[i],e[i]=a;return JSON.stringify(e)}})}.call(this);
//# sourceMappingURL=https://academia.edu/assets/maps/mobile_reg_path-25edb27a90e6f0d406abff1711db78f0bf4e00c927f1ed0a8b5e2ff1608a024e.js.map
