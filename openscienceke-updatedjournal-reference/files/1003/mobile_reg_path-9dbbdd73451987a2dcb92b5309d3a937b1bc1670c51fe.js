(function(){this.MobileRegPath||(this.MobileRegPath={}),this.MobileRegPath.notifier=new c.Server.Notification("msutd"),this.MobileRegPath.notifier.notifyAndLog=function(e,t){return null==t&&(t={}),$a.log(e),this.notify({event_type:e,location:null!=t.location?t.location:void 0,attachment_id:null!=t.attachment_id?t.attachment_id:void 0,auvid:$auvid})}}).call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/layout"]=function(e){var t=[],i=e||{};return function(e){t.push('<div id="mobile_reg_path" class="DesignSystem"><div class="full-screen-modal-header u-pv4x u-taCenter"><img'+jade.attr("src",""+e("academia-logo-redesign-2015.svg"),!0,!1)+jade.attr("onerror","this.onerror=null;this.src="+e("academia-logo-redesign-2015.png"),!0,!1)+' class="swp-mobile-signup-modal-header-logo"/><span class="swp-mobile-signup-modal-header-close u-positionAbsolute close-full-screen-modal u-clickable u-fs18 u-tcGrayDark">&times;</span></div><div class="container-fluid"><div class="row"><div class="col-xs-12"><div class="full-screen-modal-page-header u-taCenter u-mv4x"><span class="modal-page-header js-modal-page-header u-fs16"></span></div></div><div class="col-xs-12"><div class="full-screen-modal-page-content u-p0x"></div></div></div></div></div>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:undefined),t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/pages/app_store_popup_social_auth"]=function(e){var t=[],i=e||{};return function(e){t.push('<div id="mobile_reg_path" class="DesignSystem"><div class="full-screen-modal-header u-pv4x u-taCenter"><img'+jade.attr("src",""+e("academia-logo-redesign-2015.svg"),!0,!1)+jade.attr("onerror","this.onerror=null;this.src="+e("academia-logo-redesign-2015.png"),!0,!1)+' class="swp-mobile-signup-modal-header-logo"/><span class="swp-mobile-signup-modal-header-close u-positionAbsolute close-popup u-clickable u-fs18 u-tcGrayDark">&times;</span></div><div class="u-taCenter u-mb1x u-mt3x u-fs22 u-lineHeight1_2">Welcome to Academia.edu!</div><div class="u-taCenter u-mt2x"><img style="width: 70%"'+jade.attr("src",e("mobile_sutd_trophy.svg"),!0,!1)+'/></div><div class="u-taCenter u-fs16 u-mh4x u-tcBlack">Read your paper - and thousands of related papers - in our free iOS app.</div><div class="u-taCenter u-mt5x"><a href="https://academia.app.link/0aTKtunCPY"><img style="width: 120px"'+jade.attr("src",e("app-store-badge@2x.jpg"),!0,!1)+'/></a></div><div class="u-taCenter u-mt14x"><div style="cursor: pointer" class="u-tcGrayDark close-popup">Or click here to read your paper online.</div></div></div>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:undefined),t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/pages/enter_email_page"]=function(e){var t=[],i=e||{};return function(e){t.push('<div class="u-displayFlex u-flexColumn u-alignItemsCenter u-mv4x"><button id="google-signup-button" style="height:46px; width: 250px; padding:0 12px" class="Button Button--google u-mb4x u-mr4x"><img style="top:0px;left:0px;border-radius:1px" height="44" width="44"'+jade.attr("src",e("google/google-color.svg"),!0,!1)+' class="u-positionAbsolute"/><span style="text-transform:none;letter-spacing:0.2px;margin-left:40px;margin-right:-4px" class="u-fs14 u-fw400">Download with Google</span></button><button id="fb-signup-button" style="height:46px; width: 250px; padding:0 12px" class="Button Button--facebook u-mb4x u-mr4x"><img style="top:0px;left:0px;border-radius:1px" height="44" width="44"'+jade.attr("src",e("facebook/facebook-color.svg"),!0,!1)+' class="u-positionAbsolute"/><span style="text-transform:none;letter-spacing:0.2px;margin-left:40px;margin-right:-4px" class="u-fs14 u-fw400">Download with Facebook</span></button></div><div class="hr-heading login-hr-heading u-mb4x"><span class="hr-heading-text">or</span></div><form class="js-mobile-signup-modal-email-form"><div class="u-displayFlex u-flexColumn u-alignItemsCenter"><div class="u-mb4x u-fs16">Enter your email address</div><input type="email" placeholder="Email" class="js-email TextInput"/><input type="submit" disabled="disabled" value="Submit" class="u-mt3x js-submit-email Button Button--block Button--disabled"/></div></form>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:undefined),t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/pages/enter_name_page"]=function(){var e=[];return e.push('<form onsubmit="return false" class="js-mobile-signup-modal-final-form"><input type="text" placeholder="First Name" id="user_first_name" autocomplete="given-name" class="TextInput js-first-name"/><div class="u-mt3x"><input type="text" placeholder="Last Name" id="user_last_name" autocomplete="family-name" class="TextInput js-last-name"/></div><div class="u-mt3x"><input type="password" placeholder="Password" id="user_password" autocomplete="new-password" class="TextInput js-password"/></div><div class="u-mt3x"><input type="submit" disabled="disabled" value="Submit" class="js-submit-name Button Button--block Button--green"/></div></form>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/pages/sent_email_page"]=function(e){var t=[],i=e||{};return function(e){t.push('<div class="u-taCenter u-mb1x u-mt3x u-fs22 u-lineHeight1_2">Welcome to Academia.edu!</div><div class="u-taCenter u-mt2x"><img style="width: 70%"'+jade.attr("src",e("mobile_sutd_trophy.svg"),!0,!1)+'/></div><div class="u-taCenter u-fs16 u-tcBlack">Read your paper - and thousands of related papers - in our free iOS app.</div><div class="u-taCenter u-mt5x"><a href="https://academia.app.link/0aTKtunCPY"><img style="width: 120px"'+jade.attr("src",e("app-store-badge@2x.jpg"),!0,!1)+'/></a></div><div class="u-taCenter u-mt14x"><div style="cursor: pointer" class="u-tcGrayDark js-sent-email-finished">We\'ve also emailed a PDF copy of the paper to you. Click here to read and download your paper online.</div></div>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:undefined),t.join("")}}.call(this),function(){this.MobileRegPath.Layout=Backbone.View.extend({template:"mobile_reg_path/templates/layout",events:{"click .close-full-screen-modal":"closeMobileRegPath","click .js-sent-email-finished":function(){return this.closeMobileRegPath(!1)}},initialize:function(e){return this.container=$("#full-screen-modal"),this.attachment_id=e.attachment_id,this.model=new MobileRegPath.newUser({attachment_id:this.attachment_id,user_source:"mobile_download"}),this.recaptchaToSignup=e.recaptchaToSignup,this.container.html(this.render().el),this.container.fadeIn()},render:function(){return this.$el.html(JST[this.template]()),this.postRender(),this},postRender:function(){return this.ui={$headerText:this.$(".js-modal-page-header"),$pageContent:this.$(".full-screen-modal-page-content")},this.initializePageManager()},resetModel:function(){return this.model=new MobileRegPath.NewUser({attachment_id:this.attachment_id,user_source:"mobile_download"})},closeMobileRegPath:function(e){return null==e&&(e=!0),e&&MobileRegPath.notifier.notifyAndLog("download_closed",{attachment_id:this.attachment_id,location:this.pageManager.currentView.el.id}),this.container.fadeOut(),this.container.html(""),MobileRegPath.close=!1,$(".js-swp-mobile-get-pdf-footer").removeClass("u-displayNone")},steps:function(){return[{viewClass:MobileRegPath.EnterEmailPage,options:{model:this.model}},{viewClass:MobileRegPath.EnterNamePage,shouldSkip:function(e){return function(){return e.skipNamePage()}}(this),options:{model:this.model,recaptchaToSignup:this.recaptchaToSignup}},{viewClass:MobileRegPath.SentEmailPage,options:{model:this.model}}]},initializePageManager:function(){return this.pageManager=new Aedu.RegPath.PageManagerView({el:this.ui.$pageContent,steps:this.steps(),headerText:this.ui.$headerText})},skipNamePage:function(){return MobileRegPath.user_exists}})}.call(this),function(){this.MobileRegPath.AppStorePopupSocialAuth=Backbone.View.extend({id:"app-store-popup-social-auth",headerText:" ",template:"mobile_reg_path/templates/pages/app_store_popup_social_auth",events:{"click .close-popup":"closePopup"},initialize:function(){return this.container=$("#full-screen-modal"),this.container.html(this.render().el),this.container.fadeIn()},render:function(){return this.$el.html(JST[this.template]()),this},closePopup:function(){return this.container.fadeOut(),this.container.html("")}})}.call(this),function(){this.MobileRegPath.EnterEmailPage=Backbone.View.extend({id:"email-page",stepNumber:1,template:"mobile_reg_path/templates/pages/enter_email_page",events:{"submit .js-mobile-signup-modal-email-form":"submitEmail","change input.js-email":"toggleSubmitButton","keydown input.js-email":"toggleSubmitButton","keyup input.js-email":"toggleSubmitButton","keydown input.js-email":"logEmailTyping"},initialize:function(){return this.sentLog=!1,this.render()},render:function(){return this.$el.html(JST[this.template]()),this.postRender()},postRender:function(){var e;return this.ui={$email:this.$(".js-email"),$submit:this.$(".js-submit-email"),$googleButton:this.$("#google-signup-button"),$facebookButton:this.$("#fb-signup-button")},e=window.location.href+(window.location.search?"&":"?")+"show_app_store_popup=true",new Aedu.Auth.OauthButton.Connect.Google({el:this.ui.$googleButton,track:!0,registrationParams:{user_source:"mobile_download_social",doc_id:this.model.get("attachment_id"),successRedirectUrl:e}}),new Aedu.Auth.OauthButton.Connect.Facebook({el:this.ui.$facebookButton,track:!0,registrationParams:{user_source:"mobile_download_social",doc_id:this.model.get("attachment_id"),successRedirectUrl:e}}),this.ui.$email.focus()},checkEmail:function(){return $.ajax({type:"POST",url:$r.partial_create_registrations_path(),data:{partial_registration:{email:this.model.get("email"),attachment_id:this.model.get("attachment_id")}}})},saveEmail:function(){return this.model.set({email:this.ui.$email.val()})},submitEmail:function(e){return e.preventDefault(),MobileRegPath.notifier.notifyAndLog("attempted_submit_email"),this.saveEmail(),this.checkEmail().done(function(e){return function(t){return t.email_invalid===!0?(alert("Please enter a valid email"),MobileRegPath.notifier.notifyAndLog("validation_failure",{attachment_id:e.model.get("attachment_id"),error:"email_invalid"})):t.user_exists===!0?(MobileRegPath.notifier.notifyAndLog("email_valid",{attachment_id:e.model.get("attachment_id"),location:"existing_user"}),MobileRegPath.user_exists=!0,e.trigger("step_complete")):(MobileRegPath.notifier.notifyAndLog("email_valid",{attachment_id:e.model.get("attachment_id"),location:"new_user"}),MobileRegPath.user_exists=!1,e.trigger("step_complete"))}}(this)).fail(function(){return alert("Something went wrong")})},disableSubmitButton:function(){return this.ui.$submit.attr("disabled",!0).removeClass("Button--green").addClass("Button--disabled")},enableSubmitButton:function(){return this.ui.$submit.removeAttr("disabled").removeClass("Button--disabled").addClass("Button--green")},toggleSubmitButton:function(){return this.ui.$email.val().length>0?this.enableSubmitButton():this.disableSubmitButton()},logEmailTyping:function(){return this.sentLog||MobileRegPath.notifier.notifyAndLog("started_typing",{attachment_id:this.model.get("attachment_id"),location:"user_email"}),this.sentLog=!0}})}.call(this),function(){this.MobileRegPath.EnterNamePage=Backbone.View.extend({id:"name-page",stepNumber:2,headerText:"Enter your name and password",template:"mobile_reg_path/templates/pages/enter_name_page",events:{"change input":"toggleSubmitButtonAndLog","keydown input":"toggleSubmitButtonAndLog","keyup input":"toggleSubmitButtonAndLog"},initialize:function(e){return this.log={user_first_name:!1,user_last_name:!1,user_password:!1},this.recaptchaToSignup=e.recaptchaToSignup,this.model=e.model,this.render()},render:function(){return this.$el.html(JST[this.template](this.model.attributes)),this.postRender(),this},postRender:function(){return this.ui={$password:this.$(".js-password"),$submit:this.$(".js-submit-name"),$first_name:this.$(".js-first-name"),$last_name:this.$(".js-last-name")},this.ui.$first_name.focus(),this.recaptchaToSignup?Aedu.a_recaptcha.load().then(function(e){return function(){return Aedu.a_recaptcha.register(e.$(".js-submit-name")[0],function(t){return e.toNextPage(t)}),Aedu.a_recaptcha.moveBadgeWhenVisible(e.$(".js-submit-name")[0],document.body)}}(this)):this.$(".js-mobile-signup-modal-final-form").submit(function(e){return function(){return e.toNextPage()}}(this))},saveFields:function(){return this.model.set({password:this.ui.$password.val(),first_name:this.ui.$first_name.val(),last_name:this.ui.$last_name.val()})},generateErrorMessages:function(e){var t;return 0===e.length?"Something went wrong":(t=[],e.forEach(function(e){if("user[display_name]"!==e[0])return t.push(e[1])}),t.join("\n"))},toNextPage:function(e){return MobileRegPath.notifier.notifyAndLog("attempted_submit"),this.saveFields(),this.model.save(e).done(function(e){return function(t){var i,a,n;return n=t[0],i=t[1],a=t[2],n?(window.$current_user=JSON.parse(i.user),Aedu.User.set_current($current_user),MobileRegPath.user_confirmed=!Aedu.User.current.unconfirmed,e.trigger("step_complete")):(MobileRegPath.notifier.notifyAndLog("validation_failure",{error:JSON.stringify(a)}),alert(e.generateErrorMessages(a)),e.recaptchaToSignup?Aedu.a_recaptcha.reset(e.$(".js-submit-name")[0]):void 0)}}(this)).fail(function(){return alert("Something went wrong")})},disableSubmitButton:function(){return this.ui.$submit.attr("disabled",!0).removeClass("Button--green").addClass("Button--disabled")},enableSubmitButton:function(){return this.ui.$submit.removeAttr("disabled").removeClass("Button--disabled").addClass("Button--green")},toggleSubmitButtonAndLog:function(e){if(this.ui.$password.val().length>0&&this.ui.$first_name.val().length>0&&this.ui.$last_name.val().length>0?this.enableSubmitButton():this.disableSubmitButton(),!this.log[e.target.id])return MobileRegPath.notifier.notifyAndLog("started_typing",{location:e.target.id}),this.log[e.target.id]=!0}})}.call(this),function(){this.MobileRegPath.SentEmailPage=Backbone.View.extend({id:"sent-email-page",stepNumber:3,headerText:" ",template:"mobile_reg_path/templates/pages/sent_email_page",initialize:function(){return this.render()},render:function(){return this.$el.html(JST[this.template]()),this.$(".js-sent-email-finished").click(function(){return function(e){return e.preventDefault(),e.stopPropagation(),window.location.reload()}}()),this}})}.call(this),function(){this.MobileRegPath.newUser=Backbone.Model.extend({save:function(e){return this.savingToServer?$.Deferred():(this.savingToServer=!0,$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:$r.registrations_path(),data:this.dataForSave({"g-recaptcha-response":e}),complete:function(e){return function(){return e.savingToServer=!1}}(this)}))},dataForSave:function(e){var t,i,a;t={user:{email:this.get("email"),first_name:this.get("first_name"),last_name:this.get("last_name"),password:this.get("password")},doc_id:this.get("attachment_id"),user_source:this.get("user_source"),splash:this.get("splash"),login_redirect:this.get("login_redirect"),user_occupation:this.get("user_occupation")};for(i in e)a=e[i],t[i]=a;return JSON.stringify(t)}})}.call(this);
//# sourceMappingURL=https://academia.edu/assets/maps/mobile_reg_path-b95f30c3e96a6e0489a6b9c3ce491350d826697e60b5fec7cf95fd20a868364b.js.map
