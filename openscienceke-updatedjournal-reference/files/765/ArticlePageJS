var ArtMetric={},App,SCM;ArtMetric.fullVersion=function(n,t){if(n.find(".widget-ArticleLevelMetrics").length<1){var r=function(){return function(n){n.on("draw",function(n){if(n.type==="label"){var t=n.element._node.childNodes[0];t.innerHTML=t.innerText}})}},i=$("#hfSiteURL");typeof i!="undefined"&&typeof i.val()!="undefined"&&i!=""&&(t="//"+i.val()+t);$.ajax({url:t,datatype:"HTML",success:function(t){n.prepend(t);setTimeout(function(){if(typeof ChartistData!="undefined"){var n={lineSmooth:!1,showArea:!0,low:0,plugins:[r()]},t=[["screen and (max-width: 1024px)",{axisX:{labelInterpolationFnc:function(n){return n.slice(0,3)}}}],["screen and (min-width: 1px)",{axisX:{labelInterpolationFnc:function(n){return n.replace(" ","<br />")}},plugins:[r()]}]];ArtMetric.createChart(".ct-chart",window.ChartistData.data,n,t)}},200)},error:function(n,t){if(window.console){var i=eval("("+n.responseText+")");console.log("error: "+i);console.log("status: "+t)}}})}};ArtMetric.limitLabels=function(){var n=$(".ct-horizontal.ct-label"),i=n.length,r=Math.ceil(i/8),t=1;n.not(":eq(0)").each(function(){t%r==0||$(this).hide();t++})};ArtMetric.createChart=function(n,t,i,r){var o=new Chartist.Line(n,t,i,r),u=0,f=25,e=250;o.on("created",function(){u=0;ArtMetric.limitLabels()});o.on("draw",function(n){(n.type==="line"||n.type==="point"||n.type==="area")&&u++;n.type==="line"?n.element.animate({opacity:{begin:u*f+150,dur:e,from:0,to:1}}):n.type==="point"?n.element.animate({x1:{begin:u*f,dur:e,from:n.x-10,to:n.x,easing:"easeOutQuart"},x2:{begin:u*f,dur:e,from:n.x-10,to:n.x,easing:"easeOutQuart"},opacity:{begin:u*f,dur:e,from:0,to:1,easing:"easeOutQuart"}}):n.type==="area"&&n.element.animate({opacity:{begin:u*f+250,dur:300,from:0,to:1}})})};ArtMetric.triggerModal=function(n,t){var u="/ThirdParty/ArticleLevelMetricsDetails?articleId="+t,i,r;ArtMetric.fullVersion(n,u);i=$(".artmet-modal");r=$("body");i.css({display:"block",opacity:1});r.addClass("metrics-modal-open")};ArtMetric.closeModal=function(){var n=$(".artmet-modal"),t=$("body");n.attr("style","");t.removeClass("metrics-modal-open")};ArtMetric.eventsToClose=function(){$(".artmet-close-modal").click(function(){ArtMetric.closeModal()});$(".artmet-modal").click(function(){$(event.target).closest(".artmet-modal-contents").length||ArtMetric.closeModal()})};$(document).ready(function(){$(".artmet-modal-trigger, .artmet-condensed-stats .artmet-views").click(function(){var n=$(".artmet-modal-trigger").attr("data-article-id");ArtMetric.triggerModal($(".artmet-modal-contents"),n)});ArtMetric.eventsToClose()});SCM=SCM||{};SCM.Utilities=SCM.Utilities||{};SCM.Utilities.LocalStorage=function(){"use strict";function c(t,i,u){var u=u?u:r;u.setItem(n+"."+t,JSON.stringify(i))}function l(t,i){var i=i?i:r,u=i.getItem(n+"."+t);return JSON.parse(u)}function a(t,i){var i=i?i:r;i.removeItem(n+"."+t)}function v(t,r,u){var h=i(u)+"."+t,f,o;return SCM.Utilities.LocalStorage.setItem(h,r),s(u,t),CrossStorageClient===undefined?(console.error("CrossStorageClient library is not available.  Falling back to localStorage"),f=Promise.reject("CrossStorageClient library is not available")):(o=e(u),f=o.onConnect().then(function(){return o.set(n+"."+t,JSON.stringify(r))})["catch"](function(n){console.error("Failed to retrieve / set cross-domain localStorage :: "+n.message)})),f}function o(t,r){var o=i(r)+"."+t,u,f;return CrossStorageClient===undefined?(console.error("CrossStorageClient library is not available."),u=Promise.reject("CrossStorageClient library is not available")):(f=e(r),u=f.onConnect().then(function(){return f.get(n+"."+t)}).then(function(n){return JSON.parse(n)})["catch"](function(n){console.error("Failed to retrieve from cross-domain localStorage (nocache) :: "+n.message);n.message.includes("Could not access localStorage in hub")&&console.warn("It seems that the browser is set to block third-party cookies and data.  Cross-domain localStorage cannot function in this state.");throw n;})),u}function y(n,t){var r=i(t)+"."+n;return CrossStorageClient===undefined?console.error("CrossStorageClient library is not available.  Falling back to localStorage"):h(t,n)||b(t,n)||(w(t,n),o(n,t).then(function(i){i&&(h(t,n)||(s(t,n),SCM.Utilities.LocalStorage.setItem(r,i)))})["catch"](function(n){console.error("Failed to retrieve from cross-domain localStorage :: "+n.message)})),SCM.Utilities.LocalStorage.getItem(r)}function p(t,r){if(CrossStorageClient===undefined)console.error("CrossStorageClient library is not available.  Falling back to localStorage");else{var u=e(r);u.onConnect().then(function(){return u.del(n+"."+t)})["catch"](function(n){console.error("Failed to save to cross-domain localStorage :: "+n.message)})}SCM.Utilities.LocalStorage.removeItem(i(r)+"."+t)}function i(n){return $("<a>",{href:n}).prop("hostname")}function e(n){for(var r,i=0;i<t.length;i++)if(t[i].hubUrl===n)return t[i].storage;return r=new CrossStorageClient(n,{timeout:15e3}),t.push({hubUrl:n,storage:r}),r}function s(n,t){var i=n+"::"+t;u.indexOf(i)===-1&&u.push(i)}function h(n,t){var i=n+"::"+t;return u.indexOf(i)!==-1}function w(n,t){var i=n+"::"+t;f.indexOf(i)===-1&&f.push(i)}function b(n,t){var i=n+"::"+t;return f.indexOf(i)!==-1}var n="SCM",r=window.localStorage,u=[],f=[],t=[];return{getItem:l,setItem:c,removeItem:a,getItemCrossDomainNoCache:o,getItemCrossDomain:y,setItemCrossDomain:v,removeItemCrossDomain:p}}();SCM=SCM||{};App=App||{},function(n,t,i,r){var u="instOpenUrlKey_";n.replaceOpenUrlPlaceHolders=function(n,i){i!==null&&i!==""&&n.each(function(){var n=t(this).attr("data-targetId"),r=i.replace("{openUrlTargetId}",n);t(this).html(r);t(this).parent().show()})};n.getAndReplaceOpenUrlPlaceHolders=function(r){t.ajax({type:"POST",url:"/ThirdParty/InstitutionOpenUrlTemplate",dataType:"json",success:function(t){if(t!==null&&t!=="undefined"){var f="";t.DisplayOpenUrlLink==!0&&(f=t.LinkImageSource!==null&&t.LinkImageSource!==""?" <a target='_blank' href='"+t.TargetUrl+"'><img src='"+t.LinkImageSource+"'/><\/a> ":" <a target='_blank' href='"+t.TargetUrl+"'> "+t.LinkImageText+" <\/a> ");n.replaceOpenUrlPlaceHolders(r,f);i!==null&&window.sessionStorage!==null&&typeof window.App.LoginUserInfo!="undefined"&&typeof window.App.LoginUserInfo.currentSessionId!="undefined"&&i.setItem(u+window.App.LoginUserInfo.currentSessionId,f,window.sessionStorage)}},error:function(){}})};n.checkAndReplaceOpenUrlPlaceHolders=function(){var f,e;typeof window.App.LoginUserInfo!="undefined"&&window.App.LoginUserInfo.isInstLoggedIn>0&&(f=t('span[class="inst-open-url-holders"]'),f!==null&&f!==r&&f.length>0&&(i!==null&&window.sessionStorage!==null&&typeof window.App.LoginUserInfo.currentSessionId!="undefined"?(e=i.getItem(u+window.App.LoginUserInfo.currentSessionId,window.sessionStorage),e!==null?n.replaceOpenUrlPlaceHolders(f,e):n.getAndReplaceOpenUrlPlaceHolders(f)):n.getAndReplaceOpenUrlPlaceHolders(f)))};n.init=function(){n.checkAndReplaceOpenUrlPlaceHolders()}}(SCM.InstitutionOpenUrl=SCM.InstitutionOpenUrl||{},jQuery,SCM.Utilities.LocalStorage);SCM=SCM||{},function(n,t,i,r){var u=t("#ArticleFullTextWrap"),f=!1;u&&u.attr("data-userHasAccess")&&(f=u.attr("data-userHasAccess").toLowerCase()==="true");n.replaceContentLinks=function(){if(!f){var n=u.find("a[data-reveal-id]");n.each(function(){t(this).replaceWith(function(){var n=this.innerHTML;return"<span>"+n+"<\/span>"})})}};n.init=function(){n.replaceContentLinks();r.init();i.init()}}(SCM.ArticleFulltext=SCM.ArticleFulltext||{},jQuery,SCM.InstitutionOpenUrl,SCM.Utilities.Brightcove);$(document).ready(function(){var n,f;if($(".js-deepdyve-link").hide(),n=$(".js-deepdyve-link"),n.length>0){var t=n.data("doi"),i=n.data("issn"),r=n.data("fieldname"),u=n.data("affiliate");t!=null&&r!=null&&u!=null&&i!=null&&(f="https:////www.deepdyve.com/rental-link?docId="+t+"&journal="+i+"&fieldName="+r+"&affiliateId="+u+"&format=jsonp&callback=?",$.getJSON(f,function(n){n.status==="ok"&&($(".js-deepdyve-link a").attr("href",n.url),$(".js-deepdyve-link").show())}))}});$(document).ready(function(){$("a.js-view-large").on("click",function(){var n=$("#hfArticleTitle").val(),t;n!=null&&n!=""&&(t=$(this).attr("href"),n=encodeURIComponent(n))})})