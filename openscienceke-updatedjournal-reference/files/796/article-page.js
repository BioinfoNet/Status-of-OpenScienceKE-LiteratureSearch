var ArtMetric={fullVersion:function($dest,routeUrl){if($dest.find(".widget-ArticleLevelMetrics").length<1){var ctHtmlLabels=function(e){return function(e){e.on("draw",function(e){if("label"===e.type){var t=e.element._node.childNodes[0];t.innerHTML=t.innerText}})}},baseSiteUrl=$("#hfSiteURL");void 0!==baseSiteUrl&&void 0!==baseSiteUrl.val()&&""!=baseSiteUrl&&(routeUrl="//"+baseSiteUrl.val()+routeUrl),$.ajax({url:routeUrl,datatype:"HTML",success:function(e){$dest.prepend(e),setTimeout(function(){if(void 0!==window.ChartistData){var e={lineSmooth:!1,showArea:!0,low:0,plugins:[ctHtmlLabels()]},t=[["screen and (max-width: 1024px)",{axisX:{labelInterpolationFnc:function(e){return e.slice(0,3)}}}],["screen and (min-width: 1px)",{axisX:{labelInterpolationFnc:function(e){return e.replace(" ","<br />")}},plugins:[ctHtmlLabels()]}]];ArtMetric.createChart(".ct-chart",window.ChartistData.data,e,t)}},200)},error:function(xmlHttpRequest,textStatus,errorThrown){if(window.console){var err=eval("("+xmlHttpRequest.responseText+")");console.log("error: "+err),console.log("status: "+textStatus)}}})}},limitLabels:function(){var e=$(".ct-horizontal.ct-label"),t=e.length,n=Math.ceil(t/8),r=1;e.not(":eq(0)").each(function(){r%n!=0&&$(this).hide(),r++})},createChart:function(e,t,n,r){var o=new Chartist.Line(e,t,n,r),a=0,i=250;o.on("created",function(){a=0,ArtMetric.limitLabels()}),o.on("draw",function(e){"line"!==e.type&&"point"!==e.type&&"area"!==e.type||a++,"line"===e.type?e.element.animate({opacity:{begin:25*a+150,dur:i,from:0,to:1}}):"point"===e.type?e.element.animate({x1:{begin:25*a,dur:i,from:e.x-10,to:e.x,easing:"easeOutQuart"},x2:{begin:25*a,dur:i,from:e.x-10,to:e.x,easing:"easeOutQuart"},opacity:{begin:25*a,dur:i,from:0,to:1,easing:"easeOutQuart"}}):"area"===e.type&&e.element.animate({opacity:{begin:25*a+250,dur:300,from:0,to:1}})})},triggerModal:function(e,t){var n="/ThirdParty/ArticleLevelMetricsDetails?articleId="+t;ArtMetric.fullVersion(e,n);var r=$(".artmet-modal"),o=$("body");r.css({display:"block",opacity:1}),o.addClass("metrics-modal-open")},closeModal:function(){var e=$(".artmet-modal"),t=$("body");e.attr("style",""),t.removeClass("metrics-modal-open")},eventsToClose:function(){$(".artmet-close-modal").click(function(){ArtMetric.closeModal()}),$(".artmet-modal").click(function(){$(event.target).closest(".artmet-modal-contents").length||ArtMetric.closeModal()})}};$(document).ready(function(){$(".artmet-modal-trigger, .artmet-condensed-stats .artmet-views").click(function(){var e=$(".artmet-modal-trigger").attr("data-article-id");ArtMetric.triggerModal($(".artmet-modal-contents"),e)}),ArtMetric.eventsToClose()});var SCM=SCM||{};SCM.Utilities=SCM.Utilities||{},SCM.Utilities.LocalStorage=function(){"use strict";var i="SCM",r=window.localStorage,o=[],a=[],l=[];return{getItem:function(e,t){var n=(t=t||r).getItem(i+"."+e);return JSON.parse(n)},setItem:function(e,t,n){(n=n||r).setItem(i+"."+e,JSON.stringify(t))},removeItem:function(e,t){(t=t||r).removeItem(i+"."+e)},getItemCrossDomainNoCache:s,getItemCrossDomain:function(t,n){var r=c(n)+"."+t;void 0===CrossStorageClient?console.error("CrossStorageClient library is not available.  Falling back to localStorage"):f(n,t)||(o=n+"::"+t,-1!==a.indexOf(o))||(e=n+"::"+t,-1===a.indexOf(e)&&a.push(e),s(t,n).then(function(e){e&&(f(n,t)||(d(n,t),SCM.Utilities.LocalStorage.setItem(r,e)))}).catch(function(e){console.error("Failed to retrieve from cross-domain localStorage :: "+e.message)}));var e;var o;return SCM.Utilities.LocalStorage.getItem(r)},setItemCrossDomain:function(e,t,n){var r,o=c(n)+"."+e;if(SCM.Utilities.LocalStorage.setItem(o,t),d(n,e),void 0===CrossStorageClient)console.error("CrossStorageClient library is not available.  Falling back to localStorage"),r=Promise.reject("CrossStorageClient library is not available");else{var a=u(n);r=a.onConnect().then(function(){return a.set(i+"."+e,JSON.stringify(t))}).catch(function(e){console.error("Failed to retrieve / set cross-domain localStorage :: "+e.message)})}return r},removeItemCrossDomain:function(e,t){if(void 0===CrossStorageClient)console.error("CrossStorageClient library is not available.  Falling back to localStorage");else{var n=u(t);n.onConnect().then(function(){return n.del(i+"."+e)}).catch(function(e){console.error("Failed to save to cross-domain localStorage :: "+e.message)})}SCM.Utilities.LocalStorage.removeItem(c(t)+"."+e)}};function s(t,e){var n;c(e);if(void 0===CrossStorageClient)console.error("CrossStorageClient library is not available."),n=Promise.reject("CrossStorageClient library is not available");else{var r=u(e);n=r.onConnect().then(function(e){return r.get(i+"."+t)}).then(function(e){return JSON.parse(e)}).catch(function(e){throw console.error("Failed to retrieve from cross-domain localStorage (nocache) :: "+e.message),e.message.includes("Could not access localStorage in hub")&&console.warn("It seems that the browser is set to block third-party cookies and data.  Cross-domain localStorage cannot function in this state."),e})}return n}function c(e){return $("<a>",{href:e}).prop("hostname")}function u(e){for(var t=0;t<l.length;t++)if(l[t].hubUrl===e)return l[t].storage;var n=new CrossStorageClient(e,{timeout:15e3});return l.push({hubUrl:e,storage:n}),n}function d(e,t){var n=e+"::"+t;-1===o.indexOf(n)&&o.push(n)}function f(e,t){var n=e+"::"+t;return-1!==o.indexOf(n)}}();var SCM=SCM||{},App=App||{};!function(r,o,a,e){var i="instOpenUrlKey_";r.replaceOpenUrlPlaceHolders=function(e,n){null!==n&&""!==n&&e.each(function(){var e=o(this).attr("data-targetId"),t=n.replace("{openUrlTargetId}",e);o(this).html(t),o(this).parent().show()})},r.getAndReplaceOpenUrlPlaceHolders=function(n){o.ajax({type:"POST",url:"/ThirdParty/InstitutionOpenUrlTemplate",dataType:"json",success:function(e){if(null!==e&&"undefined"!==e){var t="";1==e.DisplayOpenUrlLink&&(t=null!==e.LinkImageSource&&""!==e.LinkImageSource?" <a target='_blank' href='"+e.TargetUrl+"'><img src='"+e.LinkImageSource+"'/></a> ":" <a target='_blank' href='"+e.TargetUrl+"'> "+e.LinkImageText+" </a> "),r.replaceOpenUrlPlaceHolders(n,t),null!==a&&null!==window.sessionStorage&&void 0!==window.App.LoginUserInfo&&void 0!==window.App.LoginUserInfo.currentSessionId&&a.setItem(i+window.App.LoginUserInfo.currentSessionId,t,window.sessionStorage)}},error:function(e){}})},r.checkAndReplaceOpenUrlPlaceHolders=function(){if(void 0!==window.App.LoginUserInfo&&0<window.App.LoginUserInfo.isInstLoggedIn){var e=o('span[class="inst-open-url-holders"]');if(null!=e&&0<e.length)if(null!==a&&null!==window.sessionStorage&&void 0!==window.App.LoginUserInfo.currentSessionId){var t=a.getItem(i+window.App.LoginUserInfo.currentSessionId,window.sessionStorage);null!==t?r.replaceOpenUrlPlaceHolders(e,t):r.getAndReplaceOpenUrlPlaceHolders(e)}else r.getAndReplaceOpenUrlPlaceHolders(e)}},r.init=function(){r.checkAndReplaceOpenUrlPlaceHolders()}}(SCM.InstitutionOpenUrl=SCM.InstitutionOpenUrl||{},jQuery,SCM.Utilities.LocalStorage);var SCM=SCM||{};!function(e,t,n,r){var o=t("#ArticleFullTextWrap"),a=!1;o&&o.attr("data-userHasAccess")&&(a="true"===o.attr("data-userHasAccess").toLowerCase()),e.replaceContentLinks=function(){a||o.find("a[data-reveal-id]").each(function(){t(this).replaceWith(function(){return"<span>"+this.innerHTML+"</span>"})})},e.init=function(){e.replaceContentLinks(),r.init(),n.init()}}(SCM.ArticleFulltext=SCM.ArticleFulltext||{},jQuery,SCM.InstitutionOpenUrl,SCM.Utilities.Brightcove),$(document).ready(function(){$(".js-deepdyve-link").hide();var e=$(".js-deepdyve-link");if(0<e.length){var t=e.data("doi"),n=e.data("issn"),r=e.data("fieldname"),o=e.data("affiliate");if(null!=t&&null!=r&&null!=o&&null!=n){var a="https:////www.deepdyve.com/rental-link?docId="+t+"&journal="+n+"&fieldName="+r+"&affiliateId="+o+"&format=jsonp&callback=?";$.getJSON(a,function(e){"ok"===e.status&&($(".js-deepdyve-link a").attr("href",e.url),$(".js-deepdyve-link").show())})}}}),$(document).ready(function(){$("a.js-view-large").on("click",function(){var e=$("#hfArticleTitle").val();if(null!=e&&""!=e){$(this).attr("href");e=encodeURIComponent(e)}})});
//# sourceMappingURL=article-page.min.js.map
