+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(t.style[i]!==undefined)return{end:e[i]};return!1}t.fn.emulateTransitionEnd=function(e){var i=!1,n=this;t(this).one("bsTransitionEnd",function(){i=!0});var s=function(){i||t(n).trigger(t.support.transition.end)};return setTimeout(s,e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var n=t(this),s=n.data("bs.collapse"),o=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e);!s&&o.toggle&&"show"==e&&(e=!e),s||n.data("bs.collapse",s=new i(this,o)),"string"==typeof e&&s[e]()})}var i=function(e,n){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,n),this.transitioning=null,this.options.parent&&(this.$parent=t(this.options.parent)),this.options.toggle&&this.toggle()};i.VERSION="3.2.0",i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var i=t.Event("show.bs.collapse");if(this.$element.trigger(i),!i.isDefaultPrevented()){var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var s=n.data("bs.collapse");if(s&&s.transitioning)return;e.call(n,"hide"),s||n.data("bs.collapse",null)}var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0),this.transitioning=1;var r=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return r.call(this);var a=t.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",t.proxy(r,this)).emulateTransitionEnd(350)[o](this.$element[0][a])}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var n=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};if(!t.support.transition)return n.call(this);this.$element[i](0).one("bsTransitionEnd",t.proxy(n,this)).emulateTransitionEnd(350)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=t.fn.collapse;t.fn.collapse=e,t.fn.collapse.Constructor=i,t.fn.collapse.noConflict=function(){return t.fn.collapse=n,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(i){var n,s=t(this),o=s.attr("data-target")||i.preventDefault()||(n=s.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),r=t(o),a=r.data("bs.collapse"),u=a?"toggle":s.data(),l=s.attr("data-parent"),c=l&&t(l);a&&a.transitioning||(c&&c.find('[data-toggle="collapse"][data-parent="'+l+'"]').not(s).addClass("collapsed"),s[r.hasClass("in")?"addClass":"removeClass"]("collapsed")),e.call(r,u)})}(jQuery),function(){this.MobileRegPath||(this.MobileRegPath={}),this.MobileRegPath.notifier=new c.Server.Notification("msutd"),this.MobileRegPath.notifier.notifyAndLog=function(t,e){return null==e&&(e={}),$a.log(t),this.notify({event_type:t,location:null!=e.location?e.location:void 0,attachment_id:null!=e.attachment_id?e.attachment_id:void 0,auvid:$auvid})}}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/layout"]=function(t){var e=[],i=t||{};return function(t){e.push('<div id="mobile_reg_path" class="DesignSystem"><div class="full-screen-modal-header u-pv4x u-taCenter"><img'+jade.attr("src",""+t("academia-logo-redesign-2015.svg"),!0,!1)+jade.attr("onerror","this.onerror=null;this.src="+t("academia-logo-redesign-2015.png"),!0,!1)+' class="swp-mobile-signup-modal-header-logo"/><span class="swp-mobile-signup-modal-header-close u-positionAbsolute close-full-screen-modal u-clickable u-fs18 u-tcGrayDark">&times;</span></div><div class="container-fluid"><div class="row"><div class="col-xs-12"><div class="full-screen-modal-page-header u-taCenter u-mv4x"><span class="modal-page-header js-modal-page-header u-fs16"></span></div></div><div class="col-xs-12"><div class="full-screen-modal-page-content u-p0x"></div></div></div></div></div>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:undefined),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/pages/app_store_popup_social_auth"]=function(t){var e=[],i=t||{};return function(t){e.push('<div id="mobile_reg_path" class="DesignSystem"><div class="full-screen-modal-header u-pv4x u-taCenter"><img'+jade.attr("src",""+t("academia-logo-redesign-2015.svg"),!0,!1)+jade.attr("onerror","this.onerror=null;this.src="+t("academia-logo-redesign-2015.png"),!0,!1)+' class="swp-mobile-signup-modal-header-logo"/><span class="swp-mobile-signup-modal-header-close u-positionAbsolute close-popup u-clickable u-fs18 u-tcGrayDark">&times;</span></div><div class="u-taCenter u-mb1x u-mt3x u-fs22 u-lineHeight1_2">Welcome to Academia.edu!</div><div class="u-taCenter u-mt2x"><img style="width: 70%"'+jade.attr("src",t("mobile_sutd_trophy.svg"),!0,!1)+'/></div><div class="u-taCenter u-fs16 u-mh4x u-tcBlack">Read your paper - and thousands of related papers - in our free iOS app.</div><div class="u-taCenter u-mt5x"><a href="https://academia.app.link/0aTKtunCPY"><img style="width: 120px"'+jade.attr("src",t("app-store-badge@2x.jpg"),!0,!1)+'/></a></div><div class="u-taCenter u-mt14x"><div style="cursor: pointer" class="u-tcGrayDark close-popup">Or click here to read your paper online.</div></div></div>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:undefined),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/pages/enter_email_page"]=function(t){var e=[],i=t||{};return function(t){e.push('<div class="u-displayFlex u-flexColumn u-alignItemsCenter u-mv4x"><button id="google-signup-button" style="height:46px; width: 250px; padding:0 12px" class="Button Button--google u-mb4x u-mr4x"><img style="top:0px;left:0px;border-radius:1px" height="44" width="44"'+jade.attr("src",t("google/google-color.svg"),!0,!1)+' class="u-positionAbsolute"/><span style="text-transform:none;letter-spacing:0.2px;margin-left:40px;margin-right:-4px" class="u-fs14 u-fw400">Download with Google</span></button><button id="fb-signup-button" style="height:46px; width: 250px; padding:0 12px" class="Button Button--facebook u-mb4x u-mr4x"><img style="top:0px;left:0px;border-radius:1px" height="44" width="44"'+jade.attr("src",t("facebook/facebook-color.svg"),!0,!1)+' class="u-positionAbsolute"/><span style="text-transform:none;letter-spacing:0.2px;margin-left:40px;margin-right:-4px" class="u-fs14 u-fw400">Download with Facebook</span></button></div><div class="hr-heading login-hr-heading u-mb4x"><span class="hr-heading-text">or</span></div><form class="js-mobile-signup-modal-email-form"><div class="u-displayFlex u-flexColumn u-alignItemsCenter"><div class="u-mb4x u-fs16">Enter your email address</div><input type="email" placeholder="Email" class="js-email TextInput"/><input type="submit" disabled="disabled" value="Submit" class="u-mt3x js-submit-email Button Button--block Button--disabled"/></div></form>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:undefined),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/pages/enter_name_page"]=function(){var t=[];return t.push('<form onsubmit="return false" class="js-mobile-signup-modal-final-form"><input type="text" placeholder="First Name" id="user_first_name" autocomplete="given-name" class="TextInput js-first-name"/><div class="u-mt3x"><input type="text" placeholder="Last Name" id="user_last_name" autocomplete="family-name" class="TextInput js-last-name"/></div><div class="u-mt3x"><input type="password" placeholder="Password" id="user_password" autocomplete="new-password" class="TextInput js-password"/></div><div class="u-mt3x"><input type="submit" disabled="disabled" value="Submit" class="js-submit-name Button Button--block Button--green"/></div></form>'),t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile_reg_path/templates/pages/sent_email_page"]=function(t){var e=[],i=t||{};return function(t){e.push('<div class="u-taCenter u-mb1x u-mt3x u-fs22 u-lineHeight1_2">Welcome to Academia.edu!</div><div class="u-taCenter u-mt2x"><img style="width: 70%"'+jade.attr("src",t("mobile_sutd_trophy.svg"),!0,!1)+'/></div><div class="u-taCenter u-fs16 u-tcBlack">Read your paper - and thousands of related papers - in our free iOS app.</div><div class="u-taCenter u-mt5x"><a href="https://academia.app.link/0aTKtunCPY"><img style="width: 120px"'+jade.attr("src",t("app-store-badge@2x.jpg"),!0,!1)+'/></a></div><div class="u-taCenter u-mt14x"><div style="cursor: pointer" class="u-tcGrayDark js-sent-email-finished">We\'ve also emailed a PDF copy of the paper to you. Click here to read and download your paper online.</div></div>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:undefined),e.join("")}}.call(this),function(){this.MobileRegPath.Layout=Backbone.View.extend({template:"mobile_reg_path/templates/layout",events:{"click .close-full-screen-modal":"closeMobileRegPath","click .js-sent-email-finished":function(){return this.closeMobileRegPath(!1)}},initialize:function(t){return this.container=$("#full-screen-modal"),this.attachment_id=t.attachment_id,this.model=new MobileRegPath.newUser({attachment_id:this.attachment_id,user_source:"mobile_download"}),this.recaptchaToSignup=t.recaptchaToSignup,this.container.html(this.render().el),this.container.fadeIn()},render:function(){return this.$el.html(JST[this.template]()),this.postRender(),this},postRender:function(){return this.ui={$headerText:this.$(".js-modal-page-header"),$pageContent:this.$(".full-screen-modal-page-content")},this.initializePageManager()},resetModel:function(){return this.model=new MobileRegPath.NewUser({attachment_id:this.attachment_id,user_source:"mobile_download"})},closeMobileRegPath:function(t){return null==t&&(t=!0),t&&MobileRegPath.notifier.notifyAndLog("download_closed",{attachment_id:this.attachment_id,location:this.pageManager.currentView.el.id}),this.container.fadeOut(),this.container.html(""),MobileRegPath.close=!1,$(".js-swp-mobile-get-pdf-footer").removeClass("u-displayNone")},steps:function(){return[{viewClass:MobileRegPath.EnterEmailPage,options:{model:this.model}},{viewClass:MobileRegPath.EnterNamePage,shouldSkip:function(t){return function(){return t.skipNamePage()}}(this),options:{model:this.model,recaptchaToSignup:this.recaptchaToSignup}},{viewClass:MobileRegPath.SentEmailPage,options:{model:this.model}}]},initializePageManager:function(){return this.pageManager=new Aedu.RegPath.PageManagerView({el:this.ui.$pageContent,steps:this.steps(),headerText:this.ui.$headerText})},skipNamePage:function(){return MobileRegPath.user_exists}})}.call(this),function(){this.MobileRegPath.AppStorePopupSocialAuth=Backbone.View.extend({id:"app-store-popup-social-auth",headerText:" ",template:"mobile_reg_path/templates/pages/app_store_popup_social_auth",events:{"click .close-popup":"closePopup"},initialize:function(){return this.container=$("#full-screen-modal"),this.container.html(this.render().el),this.container.fadeIn()},render:function(){return this.$el.html(JST[this.template]()),this},closePopup:function(){return this.container.fadeOut(),this.container.html("")}})}.call(this),function(){this.MobileRegPath.EnterEmailPage=Backbone.View.extend({id:"email-page",stepNumber:1,template:"mobile_reg_path/templates/pages/enter_email_page",events:{"submit .js-mobile-signup-modal-email-form":"submitEmail","change input.js-email":"toggleSubmitButton","keydown input.js-email":"toggleSubmitButton","keyup input.js-email":"toggleSubmitButton","keydown input.js-email":"logEmailTyping"},initialize:function(){return this.sentLog=!1,this.render()},render:function(){return this.$el.html(JST[this.template]()),this.postRender()},postRender:function(){var t;return this.ui={$email:this.$(".js-email"),$submit:this.$(".js-submit-email"),$googleButton:this.$("#google-signup-button"),$facebookButton:this.$("#fb-signup-button")},t=window.location.href+(window.location.search?"&":"?")+"auto_download=true&show_app_store_popup=true",new Aedu.Auth.OauthButton.Connect.Google({el:this.ui.$googleButton,track:!0,registrationParams:{user_source:"mobile_download",doc_id:this.model.get("attachment_id"),successRedirectUrl:t}}),new Aedu.Auth.OauthButton.Connect.Facebook({el:this.ui.$facebookButton,track:!0,registrationParams:{user_source:"mobile_download",doc_id:this.model.get("attachment_id"),successRedirectUrl:t}}),this.ui.$email.focus()},checkEmail:function(){return $.ajax({type:"POST",url:$r.partial_create_registrations_path(),data:{partial_registration:{email:this.model.get("email"),attachment_id:this.model.get("attachment_id")}}})},saveEmail:function(){return this.model.set({email:this.ui.$email.val()})},submitEmail:function(t){return t.preventDefault(),MobileRegPath.notifier.notifyAndLog("attempted_submit_email"),this.saveEmail(),this.checkEmail().done(function(t){return function(e){return e.email_invalid===!0?(alert("Please enter a valid email"),MobileRegPath.notifier.notifyAndLog("validation_failure",{attachment_id:t.model.get("attachment_id"),error:"email_invalid"})):e.user_exists===!0?(MobileRegPath.notifier.notifyAndLog("email_valid",{attachment_id:t.model.get("attachment_id"),location:"existing_user"}),MobileRegPath.user_exists=!0,t.trigger("step_complete")):(MobileRegPath.notifier.notifyAndLog("email_valid",{attachment_id:t.model.get("attachment_id"),location:"new_user"}),MobileRegPath.user_exists=!1,t.trigger("step_complete"))}}(this)).fail(function(){return alert("Something went wrong")})},disableSubmitButton:function(){return this.ui.$submit.attr("disabled",!0).removeClass("Button--green").addClass("Button--disabled")},enableSubmitButton:function(){return this.ui.$submit.removeAttr("disabled").removeClass("Button--disabled").addClass("Button--green")},toggleSubmitButton:function(){return this.ui.$email.val().length>0?this.enableSubmitButton():this.disableSubmitButton()},logEmailTyping:function(){return this.sentLog||MobileRegPath.notifier.notifyAndLog("started_typing",{attachment_id:this.model.get("attachment_id"),location:"user_email"}),this.sentLog=!0}})}.call(this),function(){this.MobileRegPath.EnterNamePage=Backbone.View.extend({id:"name-page",stepNumber:2,headerText:"Enter your name and password",template:"mobile_reg_path/templates/pages/enter_name_page",events:{"change input":"toggleSubmitButtonAndLog","keydown input":"toggleSubmitButtonAndLog","keyup input":"toggleSubmitButtonAndLog"},initialize:function(t){return this.log={user_first_name:!1,user_last_name:!1,user_password:!1},this.recaptchaToSignup=t.recaptchaToSignup,this.model=t.model,this.render()},render:function(){return this.$el.html(JST[this.template](this.model.attributes)),this.postRender(),this},postRender:function(){return this.ui={$password:this.$(".js-password"),$submit:this.$(".js-submit-name"),$first_name:this.$(".js-first-name"),$last_name:this.$(".js-last-name")},this.ui.$first_name.focus(),this.recaptchaToSignup?Aedu.a_recaptcha.load().then(function(t){return function(){return Aedu.a_recaptcha.register(t.$(".js-submit-name")[0],function(e){return t.toNextPage(e)}),Aedu.a_recaptcha.moveBadgeWhenVisible(t.$(".js-submit-name")[0],document.body)}}(this)):this.$(".js-mobile-signup-modal-final-form").submit(function(t){return function(){return t.toNextPage()}}(this))},saveFields:function(){return this.model.set({password:this.ui.$password.val(),first_name:this.ui.$first_name.val(),last_name:this.ui.$last_name.val()})},generateErrorMessages:function(t){var e;return 0===t.length?"Something went wrong":(e=[],t.forEach(function(t){if("user[display_name]"!==t[0])return e.push(t[1])}),e.join("\n"))},toNextPage:function(t){return MobileRegPath.notifier.notifyAndLog("attempted_submit"),this.saveFields(),this.model.save(t).done(function(t){return function(e){var i,n,s;return s=e[0],i=e[1],n=e[2],s?(window.$current_user=JSON.parse(i.user),Aedu.User.set_current($current_user),MobileRegPath.user_confirmed=!Aedu.User.current.unconfirmed,t.trigger("step_complete")):(MobileRegPath.notifier.notifyAndLog("validation_failure",{error:JSON.stringify(n)}),alert(t.generateErrorMessages(n)),t.recaptchaToSignup?Aedu.a_recaptcha.reset(t.$(".js-submit-name")[0]):void 0)}}(this)).fail(function(){return alert("Something went wrong")})},disableSubmitButton:function(){return this.ui.$submit.attr("disabled",!0).removeClass("Button--green").addClass("Button--disabled")},enableSubmitButton:function(){return this.ui.$submit.removeAttr("disabled").removeClass("Button--disabled").addClass("Button--green")},toggleSubmitButtonAndLog:function(t){if(this.ui.$password.val().length>0&&this.ui.$first_name.val().length>0&&this.ui.$last_name.val().length>0?this.enableSubmitButton():this.disableSubmitButton(),!this.log[t.target.id])return MobileRegPath.notifier.notifyAndLog("started_typing",{location:t.target.id}),this.log[t.target.id]=!0}})}.call(this),function(){this.MobileRegPath.SentEmailPage=Backbone.View.extend({id:"sent-email-page",stepNumber:3,headerText:" ",template:"mobile_reg_path/templates/pages/sent_email_page",initialize:function(){return this.render()},render:function(){return this.$el.html(JST[this.template]()),this.$(".js-sent-email-finished").click(function(){return function(t){return t.preventDefault(),t.stopPropagation(),window.location.reload()}}()),this}})}.call(this),function(){this.MobileRegPath.newUser=Backbone.Model.extend({save:function(t){return this.savingToServer?$.Deferred():(this.savingToServer=!0,$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:$r.registrations_path(),data:this.dataForSave({"g-recaptcha-response":t}),complete:function(t){return function(){return t.savingToServer=!1}}(this)}))},dataForSave:function(t){var e,i,n;e={user:{email:this.get("email"),first_name:this.get("first_name"),last_name:this.get("last_name"),password:this.get("password")},doc_id:this.get("attachment_id"),user_source:this.get("user_source"),splash:this.get("splash"),login_redirect:this.get("login_redirect"),user_occupation:this.get("user_occupation")};for(i in t)n=t[i],e[i]=n;return JSON.stringify(e)}})}.call(this),function(){this.SessionModal={},this.SessionModal.pubSub=_.extend({},Backbone.Events)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SessionModal.Base=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(){return this.notifier=new c.Server.Notification("sutd")},i.prototype.render=function(){return $("#overlay_background").css({opacity:".6"}),$("#overlay_background").show(),this.$el.fadeIn()},i.prototype.close=function(){return this.$el.fadeOut(),$("#overlay_background").fadeOut()},i}(Backbone.View)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SessionModal.CoauthorSignup=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.events={"click .js-btn-email":"clickEmailButton"},i.prototype.initialize=function(t){return this.coauthor=t.invitedCoauthor},i.prototype.clickEmailButton=function(){var t;return(null!=(t=this.coauthor)?t.eligibleForAutoRegister():void 0)?(this.$(".js-btn-email").button("loading"),this.coauthor.autoRegister().fail(function(t){return function(){return t.$(".js-btn-email").button("reset"),t.toggleEmailForm()}}(this))):this.toggleEmailForm()},i.prototype.toggleEmailForm=function(){return this.$(".js-email-form-toggle").toggleClass("hidden")},i}(Backbone.View)}.call(this),function(){Aedu.SingleWork={},this.SingleWork={preview_controller:null,register_preview_view:function(t,e){return this.preview_controller.register_view(t,e)},show_preview:function(t){return this.preview_controller.show(t)}}}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SingleWork.AttachmentPreviewController=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.events={"click .js-preview-attachment-button[data-preview-attachment-id]":"previewLinkClicked"},i.prototype.initialize=function(t){var e;if(t.attachment&&(this.attachment=t.attachment,this.updateUI()),t.multiple_viewable_attachments&&$(".js-viewable-attachments-button").length>0&&(e=this,new HoverPopover({el:".js-viewable-attachments-button",show_delay:200,hide_delay:300,html:!0,content:this.getPopoverContent,on_shown:function(){return e.$popover_el=this.$el}})),$a.is_logged_in()&&window.performance&&window.performance.measure)return window.performance.mark("Interactive"),window.performance.measure("Time To Interactive","requestStart","Interactive"),window.sendUserTiming("Time To Interactive")},i.prototype.previewLinkClicked=function(t){var e;if(e=$(t.currentTarget).data("preview-attachment-id"),this.attachment.id!==e)return this.attachment.id=e,this.attachment.index=$(t.currentTarget).data("preview-attachment-index"),this.updateUI()},i.prototype.updateUI=function(){return SingleWork.show_preview(this.attachment.id),this.$(".js-preview-attachment-button[data-preview-attachment-id] .js-active-attachment-preview").removeClass("active-preview"),$(".js-work-download-button-container[data-preview-attachment-id]").addClass("hidden"),this.$(".js-preview-attachment-button[data-preview-attachment-id='"+this.attachment.id+"'] .js-active-attachment-preview").addClass("active-preview"),$(".js-work-download-button-container[data-preview-attachment-id='"+this.attachment.id+"']").removeClass("hidden"),this.$(".js-viewable-attachments-preview-index").text(this.attachment.index+1)},i.prototype.getPopoverContent=function(){return $(".js-viewable-attachments-popover-content").html()},i}(Backbone.View)}.call(this),function(){SingleWork.CoauthorTagApi=function(){function t(){}return t.accept=function(t,e){return this._setAccepted(t,e,!0)},t.ignore=function(t,e){return this._setAccepted(t,e,!1)},t.reset=function(t,e){return this._setAccepted(t,e,null)},t._setAccepted=function(t,e,i){return $.ajax({type:"PUT",dataType:"json",contentType:"application/json",url:$r.api_v0_work_co_author_tag_path({subdomain_param:"api",id:t,work_id:e}),data:JSON.stringify({accepted:i,coauthor_invite:this._tokenFromUrl()})})},t._tokenFromUrl=function(){return $a.query_param("coauthor_invite")},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SingleWork.CoauthorTagIgnoreModal=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.events={"click #coauthor-tag-undo-ignore":"undoIgnore"},i.prototype.show=function(){return this.$el.modal("show"),this},i.prototype.render=function(){return this.$el.modal({show:!1}),this},i.prototype.undoIgnore=function(){return this.$el.modal("hide"),SingleWork.CoauthorTagApi.reset(this.options.tag_id,this.options.work_id),SingleWork.ExternalCoauthorTagModal.open(this.options.tag_id,this.options.work_id)},i}(Backbone.View)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SingleWork.CoauthorTagToolbar=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.id="coauthor-tag-request-toolbar",i.prototype.template="single_work/templates/coauthor_request_toolbar_ds",i.prototype.className="row coauthor-tag-request-toolbar-ds DesignSystem alert clearfix",i.prototype.events={"click .js-ignore-coauthor-tag-request":"ignoreCoauthorRequest","click .js-accept-coauthor-tag-request":"acceptCoauthorRequest"},i.prototype.initialize=function(t){return this.options=t},i.prototype.render=function(){return this.$el.html(JST[this.template]()),this},i.prototype.close=function(){return $(".js-work-body-wrapper").removeClass("coauthor-toolbar-present"),this.remove()},i.prototype.alertSuccess=function(){return this.$el.removeClass("alert-warning alert-danger"),this.$el.addClass("alert-success text-center"),this.$(".coauthor-tag-request-prompt").text("You have successfully been added as a co-author!"),this.hideActions()},i.prototype.alertError=function(){return this.$el.removeClass("alert-warning"),this.$el.addClass("alert-danger"),this.$(".coauthor-tag-request-prompt").text("Oops! We encountered an error and failed to process your request.")},i.prototype.hideActions=function(){return this.$(".js-coauthor-ignore").hide(),this.$(".js-coauthor-accept").hide(),this.$(".js-coauthor-msg").removeClass("col-xs-9").addClass("col-xs-12").addClass("u-taCenter")},i.prototype.acceptCoauthorRequest=function(){},i.prototype.ignoreCoauthorRequest=function(){},i}(Backbone.View)}.call(this),function(){SingleWork.CsvView=function(){function t(t){this.container=t.container,this.identifier=t.identifier,this.attachment_id=t.attachment_id,this.$container=$(this.container),this.content=null}return t.prototype.show=function(){var t;return this.$container.find(".info_box").hide(),this.$container.find(".csv_preview_loader").show(),null!==this.content?this.$container.html(this.content):(t=$r.attachment_csv_preview_path({attachment_id:this.attachment_id}),$.ajax({url:t,dataType:"json",success:function(t){return function(e){return t.content=e.content,t.$container.html(t.content)}}(this),error:function(t){return function(){return t.$container.find(".csv_preview_loader").hide(),t.$container.find(".info_box").show()}}(this)}))},t}()}.call(this),$(".js-swp-view-discussion-tooltip").tooltip({placement:function(){var t=$(window).scrollTop();return $(".js-swp-view-discussion-tooltip").offset().top-t>32?"top":"bottom"}}),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SingleWork.ExternalCoauthorTagModal=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.open=function(t,e,i,n){var s,o;return s=new SingleWork.ExternalCoauthorTagModal({el:".js-coauthor-invite-modal",tag_id:t,work_id:e,coauthor:i,abTestsHash:n}),s.render().show(),o=new SingleWork.ExternalCoauthorTagToolbar({tag_id:t,work_id:e,ab_tests_hash:n}),$(".js-work-body-wrapper").prepend(o.render().el)},i.prototype.events={"click .js-coauthor-invite-accept-button":"acceptCoauthorRequest"},i.prototype.initialize=function(){return this.abTestsHash=this.options.abTestsHash,this.notify("external_coauthor_invite_modal_render"),i.__super__.initialize.apply(this,arguments),this.coauthor=this.options.coauthor},i.prototype.show=function(){return this.$el.modal("show"),this},i.prototype.render=function(){return this.$el.modal({show:!1}),this.postRender(),this},i.prototype.postRender=function(){return this.ui={$acceptButtonText:this.$(".js-coauthor-invite-accept-text"),$acceptButtonSpinner:this.$(".js-coauthor-invite-accept-spinner")}},i.prototype.showSignupModal=function(t){return this.notify("external_coauthor_invite_verify_modal_render",{reason:t}),this.$el.modal("hide"),$(".coauthor-verify-modal").modal("show")},i.prototype.acceptCoauthorRequest=function(){var t;return this.notify("external_coauthor_invite_accept",{location:"modal"}),(null!=(t=this.coauthor)?t.eligibleForAutoRegister():void 0)?this.autoRegisterUser():this.showSignupModal("one_click_ineligible")},i.prototype.autoRegisterUser=function(){return this.showAcceptSpinner(),this.coauthor.autoRegister().fail(function(t){return function(){return t.hideAcceptSpinner(),t.showSignupModal("error_fallback")}}(this))},i.prototype.hideAcceptSpinner=function(){return this.ui.$acceptButtonText.removeClass("hidden"),this.ui.$acceptButtonSpinner.addClass("hidden")},i.prototype.showAcceptSpinner=function(){return this.ui.$acceptButtonText.addClass("hidden"),this.ui.$acceptButtonSpinner.removeClass("hidden")},i.prototype.alertSuccess=function(){return this.$el.removeClass("alert-warning alert-danger"),this.$el.addClass("alert-success text-center"),this.$(".coauthor-tag-request-prompt").text("You have successfully been added as a co-author!"),this.hideActions()},i.prototype.alertError=function(){return this.$el.removeClass("alert-warning"),this.$el.addClass("alert-danger"),this.$(".coauthor-tag-request-prompt").text("Oops! We encountered an error and failed to process your request.")},i.prototype.notify=function(t,e){var i;return null==e&&(e={}),i=new c.Server.Notification("coauthors_flow"),i.notify(_.extend({},e,{event:t,work_id:this.options.work_id,tag_id:this.options.tag_id,ab_tests:this.abTestsHash}))},i}(Backbone.View)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SingleWork.ExternalCoauthorTagToolbar=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.acceptCoauthorRequest=function(){return this.notify("external_coauthor_invite_accept",{location:"toolbar"}),this.showSignupModal()},i.prototype.ignoreCoauthorRequest=function(){return SingleWork.CoauthorTagApi.ignore(this.options.tag_id,this.options.work_id),this.close()},i.prototype.showSignupModal=function(){return $(".coauthor-verify-modal").modal("show")},i.prototype.render=function(){return UserSource.remember("coauthor_invite"),this.notify("external_coauthor_invite_toolbar_render"),i.__super__.render.apply(this,arguments)},i.prototype.notify=function(t,e){var i;return null==e&&(e={}),i=new c.Server.Notification("coauthors_flow"),i.notify({event:t,work_id:this.options.work_id,tag_id:this.options.tag_id,location:null!=e.location?e.location:void 0,ab_tests:this.options.ab_tests_hash})},i}(SingleWork.CoauthorTagToolbar)}.call(this),function(){SingleWork.IFrameView=function(){function t(t){this.container=t.container,this.identifier=t.identifier,this.$container=$(this.container)}return t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SingleWork.InternalCoauthorTagToolbar=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.autoAccept=function(){return this.acceptCoauthorRequest()},i.prototype.acceptCoauthorRequest=function(){return $a.is_logged_in()?SingleWork.CoauthorTagApi.accept(this.options.tag_id,this.options.work_id).done(function(t){return function(){return t.alertSuccess()}}(this)).fail(function(t){return function(){return t.alertError()}}(this)):$("#nav_log_in").click()},i.prototype.ignoreCoauthorRequest=function(){return $a.is_logged_in()?SingleWork.CoauthorTagApi.ignore(this.options.tag_id,this.options.work_id).done(function(t){return function(){return t.close()}}(this)).fail(function(t){return function(){return t.alertError()}}(this)):$("#nav_log_in").click()},i}(SingleWork.CoauthorTagToolbar)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SingleWork.PendingExternalCoauthor=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(){return UserSource.remember("coauthor_invite"),
i.__super__.initialize.apply(this,arguments)},i.prototype.eligibleForAutoRegister=function(){return this.get("allow_one_click_register")&&this.get("first_name")&&this.get("last_name")&&this.get("email")&&this.get("token")},i.prototype.autoRegister=function(){var t;return t=new $.Deferred,$.ajax({type:"POST",url:"/registrations",data:{user:{first_name:this.get("first_name"),last_name:this.get("last_name"),email:this.get("email")},no_password:!0,coauthor_token:this.get("token"),coauthor_work:this.get("work_id"),user_source:"coauthor_invite"},dataType:"json",xhrFields:{withCredentials:!0}}).done(function(){return function(e){var i;return i=e[0],e[1],e[2],i?(t.resolve(),document.location.href="/StartRegPath"):t.reject()}}()).fail(function(){return function(){return t.reject()}}()),t},i}(Backbone.Model)}.call(this),function(){SingleWork.PreviewController=function(){function t(){this.views={},this.current_identifier=null}return t.prototype.show=function(t){return this.current_identifier&&this._hide_view(this.current_identifier),this.current_identifier=t,this._show_view(t)},t.prototype.register_view=function(t,e){if(null!=this.views[t])throw"Can't register multiple views for the same identifier!";if(this.views[t]=e,this.current_identifier===t)return this._show_view(t)},t.prototype._show_view=function(t){var e;return this._view_container(t).show(),null!=(e=this.views[t])&&"function"==typeof e.show?e.show():void 0},t.prototype._hide_view=function(t){var e;return null!=(e=this.views[t])&&"function"==typeof e.tear_down&&e.tear_down(),this._view_container(t).hide()},t.prototype._view_container=function(t){return $(".attachment_preview[data-attachment="+t+"]")},t}(),SingleWork.preview_controller=new SingleWork.PreviewController}.call(this),Aedu.SingleWork.CertifyButton=React.createClass({displayName:"CertifyButton",propTypes:{workTitle:React.PropTypes.string,workId:React.PropTypes.number,fieldFollowerCount:React.PropTypes.number,sourceDetails:React.PropTypes.object},componentWillMount:function(){this.certificationsStore=Flux.Certifications.WorkCertificationsStore,this.certificationsStore.initialize(this.props.workId,this.updateData,this)},componentWillUnmount:function(){this.certificationsStore.removeChangeListener(this.updateData)},getInitialState:function(){return{alreadyCertified:!0}},updateData:function(){this.setState({alreadyCertified:this.certificationsStore.currentUserAlreadyCertified(this.props.workId)})},render:function(){return this.certificationsStore.hasData(this.props.workId)?React.createElement("div",{className:"DesignSystem"},React.createElement("div",{className:this.buttonStyle(),onClick:this.startCertificationProcess},React.createElement("div",{className:"u-displayFlex"},React.createElement("i",{className:"fa fa-check u-mr2x expanded-top-card--flexible-button-icon u-displayFlex u-alignItemsCenter"}),React.createElement("span",null,this.recommendText())))):null},recommendText:function(){return this.state.alreadyCertified?"Recommended":"Recommend"},buttonStyle:function(){return this.state.alreadyCertified?"expanded-top-card--link-button u-textDecorationNone u-tcGrayDarker":"expanded-top-card--link-button u-textDecorationNone"},startCertificationProcess:function(){this.state.alreadyCertified||(params={workTitle:this.props.workTitle,workId:this.props.workId,source:"swp",sourceDetails:this.props.sourceDetails},Components.Utils.showModal(Certifications.Modals.CertificationModal,params))}}),function(){var t=["extended_fulltext","graph_traversal"];Aedu.SingleWork.RelatedWorksSidebar=React.createClass({displayName:"RelatedWorksSidebar",propTypes:{workId:React.PropTypes.number.isRequired},getInitialState:function(){return{loading:!0,worksByAlgorithm:{},fetchAttempts:0}},render:function(){var t="/admin/related_works_algorithms?work_id="+this.props.workId;return React.createElement("div",{className:"panel panel-flat"},React.createElement("div",{className:"panel-body u-p6x"},React.createElement("div",{className:"u-tcGrayDark u-textUppercase u-fw700"},"Related Papers (admin-only)",React.createElement("p",null,React.createElement("a",{href:t},"See full list of related papers"))),this.renderContent()))},renderContent:function(){return this.state.loading?React.createElement("span",null,"Loading related papers..."):this.state.worksByAlgorithm.map(this.renderAlgorithmSection)},renderAlgorithmSection:function(t){return React.createElement("div",{key:t.name},React.createElement("h2",null,t.name,":"),this.renderWorks(t.works,t.ranks))},renderWorks:function(t,e){renderedWorks=[];for(var i=0;i<t.length;i++)renderedWorks.push(this.renderWork(t[i],e[i]));return renderedWorks},renderWork:function(t,e){return React.createElement("div",{key:t.id},e+1,":",React.createElement("a",{href:t.internal_url},t.title),"\xa0by\xa0",React.createElement("a",{href:t.owner.url},t.owner.display_name))},componentDidMount:function(){this.requestData()},requestData:function(){this.setState({fetchAttempts:this.state.fetchAttempts+1}),$.when.apply($,_.map(t,function(t){return $.get($r.api_v0_work_old_related_works_path({work_id:this.props.workId,algorithm:t,subdomain_param:"api"}))}.bind(this))).done(function(){var t=_.map(arguments,function(t){return t[0]});this.setState({loading:!1,worksByAlgorithm:t})}.bind(this)).fail(function(){this.state.fetchAttempts<4&&this.requestData()}.bind(this))}})}(),function(){SingleWork.RepoView=function(){function t(t){this._set_repo_widths(),_.each(this.constructor_options,function(e){return function(i){return e[i]=t[i]}}(this)),this.$container=$(this.container)}return t.prototype.constructor_options=["container","user","repo","identifier"],t.prototype.defaults={expanded:"966px",unexpanded:"760px"},t.prototype.show=function(){return req("repo",function(t){return function(){return t.$container.append("<div class='inner_repo'></div>"),t.$repo=t.$container.find(".inner_repo"),t.$repo.width(t.defaults.unexpanded),t.$repo.repo({user:t.user,name:t.repo}),t.$repo.on("not_found",function(){return t.not_found()}),t.$repo.on("api_limited",function(){return t.api_limited()})}}(this))},t.prototype.not_found=function(){var t;return null!=(t=this.$repo)&&t.find(".repo").hide(),this.$container.find(".not_found").show()},t.prototype.api_limited=function(){var t;return null!=(t=this.$repo)&&t.find(".repo").hide(),this.$container.find(".api_limited").show()},t.prototype.unsupported_browser=function(){var t;return null!=(t=this.$repo)&&t.find(".repo").hide(),this.$container.find(".unsupported_browser").show()},t.prototype.tear_down=function(){return this.$repo.remove()},t.prototype._set_repo_widths=function(){var t;return t=$.trim($("#site").attr("class").replace("fixed","")),"w_1160"===t?(this.defaults.expanded="1060px",this.defaults.unexpanded="880px"):"w_1340"===t?(this.defaults.expanded="1246px",this.defaults.unexpanded="1050px"):"w_1780"===t?(this.defaults.expanded="1680px",this.defaults.unexpanded="1500px"):void 0},t}()}.call(this),function(){this.JST||(this.JST={}),this.JST["single_work/templates/coauthor_request_toolbar_ds"]=function(){var t=[];return t.push('<div style="line-height:44px" class="js-coauthor-msg col-xs-9 u-fs14 u-fw700"><span>You have been tagged as a co-author!</span></div><div style="line-height:44px" class="js-coauthor-ignore col-xs-1 u-tcGray"><div class="js-ignore-coauthor-tag-request ignore-coauthor-tag-request clickable">IGNORE</div></div><div class="js-coauthor-accept col-xs-2"><button class="js-accept-coauthor-tag-request Button Button--green Button--block accept-coauthor-tag-request"><span>ACCEPT</span></button></div>'),t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["single_work/templates/splash_single_step_signup_form"]=function(t){var e,i=[],n=t||{};return function(t,n){i.push('<div class="a-fadeInDown"><div class="u-taCenter u-mb2x"><h4 class="u-tcGrayDarker u-fw700">Sign Up to Download</h4></div><form onsubmit="return false" class="js-swp-splash-single-step-signup-form container-fluid u-mt8x"><div class="row"><div class="col-xs-8 col-xs-offset-2"><div class="row u-mb4x"><div class="col-xs-6 u-pl0x u-pr2x"><input placeholder="First Name" id="user_first_name" class="js-swp-splash-single-step-signup-first-name swp-splash-single-step-singup-input TextInput TextInput--xl"/></div><div class="col-xs-6 u-pl2x u-pr0x"><div class="u-positionRelative"><input placeholder="Last Name" id="user_last_name" class="js-swp-splash-single-step-signup-last-name swp-splash-single-step-singup-input TextInput TextInput--xl"/></div></div></div><div class="row u-mb4x"><div class="col-xs-12 u-ph0x"><input placeholder="Email" type="email" id="user_email" class="js-swp-splash-single-step-signup-email swp-splash-single-step-singup-input TextInput TextInput--xl"/></div></div><div class="row u-mb4x"><div class="col-xs-12 u-ph0x"><input type="password" placeholder="Password" id="user_password" class="js-swp-splash-single-step-signup-password swp-splash-single-step-singup-input TextInput TextInput--xl"/></div></div><div class="row"><div class="col-xs-12 u-ph0x"><button type="submit" class="js-swp-splash-signup-submit swp-splash-signup-submit Button Button--block Button--green Button--xl"><i'+jade.cls(["fa","fa-lg","fa-"+("pdf"===t?"file-pdf-o":"file-text-o")],[null,null,!0])+"></i>&nbsp;&nbsp;\nGET "+jade.escape(null==(e="pdf"===t?"PDF":"FILE")?"":e)+'</button></div></div><div class="row"><div class="col-xs-12 u-ph0x u-taCenter"><div class="u-tcGrayDark u-pt2x">Already have an account?\n&nbsp;<a'+jade.attr("href",n,!0,!1)+' class="u-linkUnstyled u-textDecorationUnderline">Sign in</a></div></div></div></div></div></form></div>')}.call(this,"attachmentType"in n?n.attachmentType:"undefined"!=typeof attachmentType?attachmentType:undefined,"loginUrl"in n?n.loginUrl:"undefined"!=typeof loginUrl?loginUrl:undefined),i.join("")}}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SingleWork.VerifyFulltextModal=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return this.workId=t.workId,this.attachmentId=t.attachmentId,this.notifier=new Aedu.Server.Notification("paper_uploads"),i.__super__.initialize.call(this,{mainText:"Confirm full-text attachment",confirmButtonText:"CONFIRM",cancelButtonText:"REMOVE",confirmButtonClasses:"btn-success",subText:"Is this the text of your paper, "+t.title+"?"}),this.once("confirm",function(t){return function(){return t.notifyEvent("fulltext_confirmed")}}(this)),this.once("cancel",function(t){return function(){return t.removeAttachment(),t.notifyEvent("fulltext_removed")}}(this)),this.notifyEvent("verify_fulltext_shown")},i.prototype.notifyEvent=function(t){return this.notifier.notify({event:t,user_id:Aedu.User.current.id,work_id:this.workId,attachment_id:this.attachmentId})},i.prototype.removeAttachment=function(){var t;return t=$r.api_v0_attachment_path({id:this.attachmentId,subdomain_param:"api"}),$.post(t,{_method:"DELETE"},function(t){return function(){return window.location="/"+t.workId}}(this))},i}(ConfirmModal)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SingleWork.AddAttachmentButton_v2=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return this.ui={$button_text:this.$(".btn-text"),$error_alert:this.$(".error-text")},this.done=t.done||function(){},this.uploader=new app.views.Uploader_v2({dropZone:this.$el,input:this.$("input[type=file]"),source:t.source,work_id:t.work_id,event_recorder:t.event_recorder}),this.uploader.on("add",this._clear_errors,this).on("progress",_.throttle(this._show_progress,200),this).on("fail",this._show_failure,this).on("error",this._show_errors,this).on("done",this._show_complete,this),this.$el.show(),this.uploader._record_event("swp_upload_file_shown")},i.prototype.events={"click input[type=file]":"_file_input_clicked"},i.prototype._file_input_clicked=function(){return this.uploader._record_event("upload_file_clicked")},i.prototype._show_progress=function(t){return this.ui.$button_text.text(Math.floor(t.loaded/t.total*100)+"%")},i.prototype._clear_errors=function(){return this.ui.$error_alert.hide()},i.prototype._show_errors=function(t){var e,i;return e={file_name_length:"File name is too long to upload. Please shorten and try again.",file_size:"Please choose a smaller file (less than "+$h.humanFileSize(this.uploader.max_file_size)+").",file_type:"Sorry, we don't support that file type."},i=Object.keys(t[0])[0],this.ui.$error_alert.show().text(e[i]),this.done({success:!1,message:e[i]})},i.prototype._show_failure=function(){return this.done({success:!1,message:"Something went wrong. Please try again"}),alert("Something went wrong")},i.prototype._show_complete=function(t){return this.ui.$button_text.text("Upload Complete"),this.done({success:!0,attachment:t.result.attachment})},i}(Backbone.View)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SingleWork.SplashSingleStepSignupForm=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template="single_work/templates/splash_single_step_signup_form",i.prototype.events={"keydown .js-swp-splash-single-step-signup-first-name":"logTyping","keydown .js-swp-splash-single-step-signup-email":"logTyping","keydown .js-swp-splash-single-step-signup-last-name":"logTyping","keydown .js-swp-splash-single-step-signup-password":"logTyping","focus .js-swp-splash-single-step-signup-email":"expandEmailForm"},i.prototype.initialize=function(t){var e;return this.log={user_email:!1,user_first_name:!1,user_last_name:!1,user_password:!1},this.notifier=new c.Server.Notification("sutd"),this.recaptchaToSignup=t.recaptchaToSignup,e=$a.build_url(window.location.href,_({auto:"download"}).pairs()),this.render({attachmentType:t.attachmentType,loginUrl:$a.loginUrlWithRedirect(e)})},i.prototype.render=function(t){return this.$el.html(JST[this.template](t)),this.postRender()},i.prototype.postRender=function(){return this.ui={$first_name:this.$(".js-swp-splash-single-step-signup-first-name"),$last_name:this.$(".js-swp-splash-single-step-signup-last-name"),$password:this.$(".js-swp-splash-single-step-signup-password"),$occupation:this.$(".js-swp-splash-single-step-signup-occupation"),$email:this.$(".js-swp-splash-single-step-signup-email"),$emailForm:this.$(".js-swp-splash-signup-email-form-collapsed"),$googleButton:this.$(".js-swp-splash-single-step-signup-google-button"),$facebookButton:this.$(".js-swp-splash-single-step-signup-facebook-button")},this.ui.$first_name.focus(),this.recaptchaToSignup?Aedu.a_recaptcha.load().then(function(t){return function(){return Aedu.a_recaptcha.register(t.$(".js-swp-splash-signup-submit")[0],function(e){return t.submitSignup(e)}),Aedu.a_recaptcha.moveBadgeWhenVisible(t.$(".js-swp-splash-signup-submit")[0],document.body)}}(this)):this.$(".js-swp-splash-single-step-signup-form").submit(function(t){return function(){return t.submitSignup("")}}(this)),new Aedu.Auth.OauthButton.Connect.Facebook({el:this.ui.$facebookButton,track:!0,registrationParams:{doc_id:this.model.get("attachment_id"),splash:!0}}),new Aedu.Auth.OauthButton.Connect.Google({el:this.ui.$googleButton,track:!0,registrationParams:{doc_id:this.model.get("attachment_id"),splash:!0}})},i.prototype.expandEmailForm=function(){return this.ui.$emailForm.collapse("show")},i.prototype.saveFields=function(){return this.model.set({email:this.ui.$email.val(),first_name:this.ui.$first_name.val(),last_name:this.ui.$last_name.val(),password:this.ui.$password.val(),user_occupation:this.ui.$occupation.val(),splash:!0})},i.prototype.renderErrorHTML=function(t){return"<div class='js-swp-splash-input-inner-error swp-splash-input-inner-error u-tcRed a-fadeInDownShort'>"+t+"</div>"},i.prototype.displayErrors=function(t){var e;return e=$(this.ui.$first_name).add(this.ui.$last_name).add(this.ui.$password).add(this.ui.$email).add(this.ui.$occupation),e.removeClass("TextInput--error").css({"padding-top":0}),this.$(".js-swp-splash-input-inner-error").remove(),_.each(t,function(t){return function(e){var i,n;if(n=e[0],i=e[1],"user[email]"===n&&t.showErrorForInput(t.ui.$email,i),"user[first_name]"===n&&t.showErrorForInput(t.ui.$first_name,i),"user[last_name]"===n&&t.showErrorForInput(t.ui.$last_name,i),"user[password]"===n&&t.showErrorForInput(t.ui.$password,i),"user[occupation]"===n)return t.showErrorForInput(t.ui.$occupation,i)}}(this))},i.prototype.showErrorForInput=function(t,e){return t.addClass("TextInput--error").after(this.renderErrorHTML(e.replace(/\.$/g,""))).css({"padding-top":10})},i.prototype.submitSignup=function(t){return this.saveFields(),this.model.save(t).done(function(t){return function(e){var i,n,s;return s=e[0],i=e[1],n=e[2],s?window.location.replace(i.redirect):(t.notify("validation_failure",{error:JSON.stringify(n)}),t.displayErrors(n),t.recaptchaToSignup?Aedu.a_recaptcha.reset(t.$(".js-swp-splash-signup-submit")[0]):void 0)}}(this)).fail(function(){if(alert("Something went wrong"),this.recaptchaToSignup)return Aedu.a_recaptcha.reset(this.$(".js-swp-splash-signup-submit")[0])})},i.prototype.notify=function(t,e){return null==e&&(e={}),this.notifier.notify({event_type:t,attachment_id:this.model.get("attachment_id"),auvid:$auvid,location:null!=e.location?e.location:void 0,error:null!=e.error?e.error:void 0})},i.prototype.logTyping=function(t){return this.log[t.target.id]||this.notify("started_typing",{location:t.target.id}),this.log[t.target.id]=!0},i}(Backbone.View)}.call(this),function(){Aedu.SignupToDownload||(Aedu.SignupToDownload={}),Aedu.SignupToDownload.notifier=new c.Server.Notification("sutd"),Aedu.SignupToDownload.notifier.notifyAndLog=function(t,e){return null==e&&(e={}),$a.log(t),this.notify({event_type:t,attachment_id:e.attachment_id?e.attachment_id:void 0,auvid:$auvid,location:e.location?e.location:void 0,error:e.error?e.error:void 0})}}.call(this),function(){this.JST||(this.JST={}),this.JST["signup_to_download/templates/layout"]=function(t){var e,i=[],n=t||{};return function(t,n,s,o,r){i.push('<div class="DesignSystem"><div class="modal-dialog"><div class="modal-content"><div class="modal-header container-fluid u-p0x"><div class="row u-pv6x"><div class="col-xs-8 col-xs-offset-2"><div class="u-taCenter u-fs14 u-fw700 u-tcGrayDarkest u-textUppercase u-letterSpacing1">'+jade.escape(null==(e=r)?"":e)+"</div></div>"),o&&i.push('<div class="col-xs-2"><button data-dismiss="modal" class="js-close-full-modal u-floatRight Close u-fw400 u-fs20 u-mr4x">&times;</button></div>'),i.push('</div></div><div class="modal-body container-fluid u-p10x"><div class="row u-mb10x"><div class="col-xs-12"><div class="u-taCenter"><div class="u-tcGrayDarkest u-lineHeight1_4 u-fontSerif u-fs22">'+jade.escape(null==(e=s)?"":e)+'</div></div></div></div><div class="u-displayFlex u-justifyContentCenter u-mb5x"><button id="google-signup-button" style="height:46px;padding:0 12px" class="Button Button--google u-mb4x u-mr4x"><img style="top:0px;left:0px;border-radius:1px" height="44" width="44"'+jade.attr("src",t("google/google-color.svg"),!0,!1)+' class="u-positionAbsolute"/><span style="text-transform:none;letter-spacing:0.2px;margin-left:40px;margin-right:-4px" class="u-fs14 u-fw400">Download with Google</span></button><button id="fb-signup-button" style="height:46px;padding:0 12px" class="Button Button--facebook u-mb4x u-mr4x"><img style="top:0px;left:0px;border-radius:1px" height="44" width="44"'+jade.attr("src",t("facebook/facebook-color.svg"),!0,!1)+' class="u-positionAbsolute"/><span style="text-transform:none;letter-spacing:0.2px;margin-left:40px;margin-right:-4px" class="u-fs14 u-fw400">Download with Facebook</span></button></div><div class="row u-mb5x"><div class="col-xs-12"><div class="hr-heading login-hr-heading"><span class="hr-heading-text">or</span></div></div></div><form class="js-modal-title-form container-fluid"><div class="row u-mb5x"><div class="col-xs-12 u-ph0x TextInputWrapper--icon u-floatLeft"><input placeholder="Email" type="email" id="user_email" class="TextInput TextInput--xl js-modal-title-email swp-splash-single-step-singup-input"/><i class="fa fa-envelope-o u-tcGrayDark js-modal-title-envelope"></i></div></div><div class="row"><div class="col-xs-12 collapse js-modal-title-form-collapsed"><div class="row u-mb5x"><div class="col-xs-6 u-pl0x u-pr2x"><input placeholder="First Name" id="user_first_name" class="TextInput TextInput--xl js-modal-title-first-name swp-splash-single-step-singup-input"/></div><div class="col-xs-6 u-pl2x u-pr0x"><div class="u-positionRelative"><input placeholder="Last Name" id="user_last_name" class="TextInput TextInput--xl js-modal-title-last-name swp-splash-single-step-singup-input"/></div></div></div><div class="row u-mb5x"><div class="col-xs-12 u-ph0x"><input type="password" placeholder="Password" id="user_password" class="TextInput TextInput--xl js-modal-title-password swp-splash-single-step-singup-input"/></div></div><div class="row u-mb5x"><div class="col-xs-12 u-ph0x"><button type="submit" class="js-modal-signup-submit swp-splash-signup-submit Button Button--block Button--lg Button--green">Continue to Download</button></div></div></div></div><div class="row"><div class="col-xs-12 u-ph0x u-taCenter"><div class="u-fw400 u-fs12 u-tcGrayDark">Already have an account?\n&nbsp;<a'+jade.attr("href",n,!0,!1)+' class="u-linkUnstyled u-textDecorationUnderline u-tcBlue">Log in</a></div></div></div></form></div></div></div></div>')}.call(this,"$image_url"in n?n.$image_url:"undefined"!=typeof $image_url?$image_url:undefined,"loginUrl"in n?n.loginUrl:"undefined"!=typeof loginUrl?loginUrl:undefined,"message"in n?n.message:"undefined"!=typeof message?message:undefined,"showCloseButton"in n?n.showCloseButton:"undefined"!=typeof showCloseButton?showCloseButton:undefined,"title"in n?n.title:"undefined"!=typeof title?title:undefined),i.join("")}}.call(this),function(){Aedu.SignupToDownload.Layout=Backbone.View.extend({template:"signup_to_download/templates/layout",className:"modal fade",events:{"focus .js-modal-title-email":"expandEmailForm","click .js-modal-signup-submit":"submitSignup","click .js-modal-terms-link":"termsClicked","keydown .js-modal-title-first-name":"logTyping","keydown .js-modal-title-last-name":"logTyping","keydown .js-modal-title-password":"logTyping","keydown .js-modal-title-email":"logTyping"},initialize:function(t){return null==t&&(t={}),this.model=new MobileRegPath.newUser({attachment_id:t.attachmentId,login_redirect:t.loginRedirect,user_source:t.userSource}),this.data={loginUrl:t.loginUrl||"/login",message:t.message,attachmentType:null!=t.attachmentType?t.attachmentType:void 0,title:t.title,showCloseButton:t.showCloseButton},this.log={user_email:!1,user_first_name:!1,user_last_name:!1,user_password:!1},this.render(this.data)},render:function(t){return this.$el.html(JST[this.template](t)),this.postRender()},postRender:function(){return this.ui={$emailForm:this.$(".js-modal-title-form-collapsed"),$googleButton:this.$("#google-signup-button"),$facebookButton:this.$("#fb-signup-button"),$firstName:this.$(".js-modal-title-first-name"),$lastName:this.$(".js-modal-title-last-name"),$password:this.$(".js-modal-title-password"),$email:this.$(".js-modal-title-email"),$envelope:this.$(".js-modal-title-envelope")},new Aedu.Auth.OauthButton.Connect.Facebook({el:this.ui.$facebookButton,track:!0,registrationParams:{doc_id:this.model.get("attachment_id")}}),new Aedu.Auth.OauthButton.Connect.Google({el:this.ui.$googleButton,track:!0,registrationParams:{doc_id:this.model.get("attachment_id")}}),this.$el.modal({backdrop:"static",keyboard:!1}),this.$el.on("hidden.bs.modal",function(){return Aedu.SignupToDownload.notifier.notifyAndLog("download_closed")})},expandEmailForm:function(){return this.ui.$emailForm.collapse("show")},submitSignup:function(t){if(t.preventDefault(),Aedu.SignupToDownload.notifier.notifyAndLog("attempted_submit"),this.saveFields(),!this.model.savingToServer)return this.model.save().done(function(t){return function(e){var i,n,s;return s=e[0],i=e[1],n=e[2],s?t.redirectToPage(i.redirect):(Aedu.SignupToDownload.notifier.notifyAndLog("validation_failure",{error:JSON.stringify(n)}),t.displayErrors(n))}}(this)).fail(function(){return alert("Something went wrong")})},saveFields:function(){return this.model.set({email:this.ui.$email.val(),first_name:this.ui.$firstName.val(),last_name:this.ui.$lastName.val(),password:this.ui.$password.val()})},renderErrorHTML:function(t){return"<div class='js-swp-splash-input-inner-error swp-splash-input-inner-error u-tcRed a-fadeInDownShort'>"+t+"</div>"},displayErrors:function(t){var e;return e=$(this.ui.$firstName).add(this.ui.$lastName).add(this.ui.$password).add(this.ui.$email),e.removeClass("TextInput--error").css({"padding-top":0}),this.ui.$envelope.css({"padding-top":0}),this.$(".js-swp-splash-input-inner-error").remove(),_.each(t,function(t){return function(e){var i,n;if(n=e[0],i=e[1],"user[email]"===n&&t.showErrorForEmail(t.ui.$email,i),"user[first_name]"===n&&t.showErrorForInput(t.ui.$firstName,i),"user[last_name]"===n&&t.showErrorForInput(t.ui.$lastName,i),"user[password]"===n)return t.showErrorForInput(t.ui.$password,i)}}(this))},showErrorForInput:function(t,e){return t.addClass("TextInput--error").after(this.renderErrorHTML(e.replace(/\.$/g,""))).css({"padding-top":10})},showErrorForEmail:function(t,e){return t.addClass("TextInput--error").css({"padding-top":10}),this.ui.$envelope.after(this.renderErrorHTML(e.replace(/\.$/g,""))).css({"padding-top":5})},termsClicked:function(){return Aedu.SignupToDownload.notifier.notifyAndLog("terms",{auvid:$auvid})},logTyping:function(t){if(!this.log[t.target.id])return Aedu.SignupToDownload.notifier.notifyAndLog("started_typing",{location:t.target.id}),this.log[t.target.id]=!0},redirectToPage:function(t){return window.location.replace(t)}})}.call(this),function(){this.SidebarSuggestions||(this.SidebarSuggestions={})}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestionsCollection=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(){return i.__super__.initialize.apply(this,arguments),this.on("sync",function(){if(this.displayable().length<=0)return this.trigger("empty")}),this},i.prototype.ensureMinDisplayable=function(t){return this.displayable().length<t&&!this._fetching&&(this._fetching=!0,this.fetch().always(function(t){return function(){return t._fetching=!1}}(this))),this.once("remove",function(){return this.ensureMinDisplayable(t)})},i}(Backbone.Collection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestedCertification=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return this.set("id",t.work.id),i.__super__.initialize.apply(this,arguments)},i.prototype.url=function(){return $r.api_v0_suggestions_certification_path({id:this.id,subdomain_param:"api"})},i}(Backbone.Model)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestedCertifications=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.model=SidebarSuggestions.SuggestedCertification,i.prototype.url=$r.api_v0_suggestions_certifications_path({subdomain_param:"api"}),i.prototype.displayable=function(t){return this.slice(this.length-t,this.length)},i.prototype.parse=function(t){return null!=t?t.certifications:void 0},i}(SidebarSuggestions.SuggestionsCollection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestedCoauthor=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.saveSuggestion=function(t){var e;return e=$.extend(this.get("tags")[0],{accepted:t,source:"coauthor_suggestions_sidebar"}),$.ajax({url:$r.api_v0_suggestions_coauthors_path({subdomain_param:"api"}),type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(e)})},i}(Backbone.Model)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestedDiscussion=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i}(Backbone.Model)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestedDiscussions=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.model=SidebarSuggestions.SuggestedDiscussion,i.prototype.url=$r.api_v0_suggestions_discussions_path({subdomain_param:"api",count:5}),i.prototype.parse=function(t){return null!=t?t.discussions:void 0},i.prototype.displayable=function(t){return this.slice(this.length-t,this.length)},i}(SidebarSuggestions.SuggestionsCollection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestedHistory=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return this.set("id",t.work.id),i.__super__.initialize.apply(this,arguments)},i}(Backbone.Model)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestedHistorys=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.model=SidebarSuggestions.SuggestedHistory,i.prototype.url=$r.api_v0_suggestions_certifications_path({subdomain_param:"api"}),i.prototype.displayable=function(){return this.slice(0,this.length>3?3:this.length)},i.prototype.parse=function(t){return null!=t?t.certifications:void 0},i}(SidebarSuggestions.SuggestionsCollection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestedInterest=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return this.set("id",t.interest.id),i.__super__.initialize.apply(this,arguments)},i.prototype.url=function(){return $r.api_v0_suggestions_interest_path({id:this.get("interest").id,subdomain_param:"api",s:this.sourceString()})},i.prototype.sourceString=function(){return this.get("sources").sort().join(",")},i}(Backbone.Model)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestedInterests=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.model=SidebarSuggestions.SuggestedInterest,i.prototype.url=$r.api_v0_suggestions_interests_path({subdomain_param:"api",count:12}),i.prototype.parse=function(t){return null!=t?t.interests:void 0},i.prototype.displayable=function(t){return this.filter(function(t){return!Aedu.User.current.has_interest(t.get("interest").id)}).slice(0,t)},i.prototype.removeById=function(t){var e;return e=this.findWhere({id:t
}),this.remove(e),e},i}(SidebarSuggestions.SuggestionsCollection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestedJob=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(){return i.__super__.initialize.apply(this,arguments)},i.prototype.url=function(){return $r.randomized_last_api_v0_suggestions_jobs_path({subdomain_param:"api"})},i}(Backbone.Model)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestedUser=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return this.set("id",t.user.id),i.__super__.initialize.apply(this,arguments)},i.prototype.url=function(){return $r.api_v0_suggestions_following_path({id:this.get("user").id,subdomain_param:"api",s:this.sourceString()})},i.prototype.sourceString=function(){return this.get("sources").sort().join(",")},i.prototype.followData=function(){return{"data-follow-user-id":this.get("user").id,"data-follow-user-source":"sidebar_suggestion","data-follow-user-src-details":{sources:_.escape(this.sourceString())},"data-follow-user-fname":_.escape(this.get("user").first_name)}},i.prototype.reason=function(t){var e,i,n,s,o,r,a;return null==t&&(t={}),i=t.includeLinkedNames,o=t["short"],a=this.get("user"),r=_(this.get("sources")),s=i?this._linkedName(a,a.first_name):a.first_name,r.include("AuthorsBookmarked")?o?"Saved by you.":"You have saved "+s+"'s research.":r.include("FollowedByFollowees")&&(e=this._connectingUserLinks(i)).length>0?o?s+" is followed by your people you know.":s+" is followed by "+$h.to_sentence(e.slice(0,3))+".":r.include("DepartmentColleagues")&&this.departmentName()&&this.universityName()?o?s+" is a colleague.":s+" is a colleague in "+this.departmentName()+" at "+this.universityName():r.include("FollowedBySimilarFollowers")?o?s+" is followed by academics like you.":s+" is followed by people who follow the same other academics as you.":r.include("FollowedBySimilarBookmarkers")?o?s+" is followed by academics with similar saved papers.":s+" is followed by academics who have saved the same works as you.":r.include("TopResearchInterestUsers")&&(n=this._commonInterestNames()).length>0?o?s+" is a top researcher in "+n[0]+".":s+" is among the top researchers in "+$h.to_sentence(n.slice(0,3))+" on Academia.edu.":Aedu.User.current.followee_ids.length>0?s+" is similar to other academics you follow.":s+" is someone you might know."},i.prototype.universityName=function(){var t,e;return null!=(t=this.get("user").department)&&null!=(e=t.university)?e.name:void 0},i.prototype.departmentName=function(){var t;return null!=(t=this.get("user").department)?t.name:void 0},i.prototype._commonInterestNames=function(){var t,e,i,n,s,o;if(o=this.get("user"),o.interests&&Aedu.User.current.interests){for(n=o.interests,s=[],e=0,i=n.length;e<i;e++)t=n[e],Aedu.User.current.has_interest(t.id)&&s.push(t.name);return s}return[]},i.prototype._connectingUserLinks=function(t){var e,i;return null==t&&(t=!0),e=this.get("connecting_users"),e&&t?_.shuffle(function(){var t,n,s;for(s=[],t=0,n=e.length;t<n;t++)i=e[t],s.push(this._linkedName(i,i.display_name));return s}.call(this)):e?_.shuffle(function(){var t,n,s;for(s=[],t=0,n=e.length;t<n;t++)i=e[t],s.push(i.display_name);return s}()):[]},i.prototype._linkedName=function(t,e){return $("<a/>").attr("href",t.url).addClass("u-tcGray u-textDecorationUnderline").text(e)[0].outerHTML},i}(Backbone.Model)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestedUsers=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.model=SidebarSuggestions.SuggestedUser,i.prototype.initialize=function(t,e){return null==e&&(e=10),this.url=$r.api_v0_suggestions_following_index_path({subdomain_param:"api",count:e}),i.__super__.initialize.apply(this,arguments)},i.prototype.parse=function(t){return null==(null!=t?t.following:void 0)?[]:_(t.following).map(function(t){var e;return new SidebarSuggestions.SuggestedUser({sources:t.sources,user:Aedu.User.from_json(t.user),connecting_users:function(){var i,n,s,o;for(s=t.connecting_users||[],o=[],i=0,n=s.length;i<n;i++)e=s[i],o.push(Aedu.User.from_json(e));return o}()})})},i.prototype.displayable=function(t){return this.filter(function(t){return!Aedu.User.current.follows(t.get("user").id)}).slice(0,t)},i}(SidebarSuggestions.SuggestionsCollection)}.call(this),function(){this.JST||(this.JST={}),this.JST["sidebar_suggestions/templates/suggested_affiliation"]=function(t){var e,i=[],n=t||{};return function(t){i.push('<div class="Panel u-mb5x"><div class="Panel-header u-p5x"><div class="js-sidebar-add-affiliation-university u-taCenter u-fw700 u-tcGrayDark">'+jade.escape(null==(e=t)?"":e)+'</div></div><div class="Panel-bodySegment u-p5x u-taCenter"><div class="newsfeed-sidebar-oauth-actions-new"><a class="Button js-news-sidebar-add-affiliation">&nbsp;&nbsp;Edit Affiliation</a></div></div></div><div class="DesignSystem"><div class="modal js-news-add-affiliation-modal"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><div class="modal-title"></div><div class="modal-body"><div class="js-newsfeed-add-affiliation-modal-body"></div></div></div></div></div></div></div>')}.call(this,"guessText"in n?n.guessText:"undefined"!=typeof guessText?guessText:undefined),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["sidebar_suggestions/templates/suggested_certifications"]=function(t){var e,i=[],n=t||{};return function(t,n,s,o){i.push('<ul class="u-listStyleNone u-pl0x u-mb0x">'),function(){var n=o;if("number"==typeof n.length)for(var r=0,a=n.length;r<a;r++){var u=n[r],l=u.get("work");i.push("<li"+jade.attr("id","certify_work_"+l.id,!0,!1)+' class="Panel-bodySegment u-p5x"><a'+jade.attr("href",l.internal_url,!0,!1)+" data-sidebar-truncate-to-lines='3' class=\"js-sidebar-truncate u-fw700 u-tcGrayDarker\">"+jade.escape(null==(e=l.title)?"":e)+'</a><div class="u-p1x"></div><div class="u-textTruncate u-tcGray"><a'+jade.attr("data-work-title",l.title,!0,!1)+jade.attr("data-work-id",l.id,!0,!1)+jade.attr("data-field-follower-count",u.get("potential_reach"),!0,!1)+' disabled="disabled" class="js-certification-button u-tcGreen u-fw700 u-clickable"><i class="fa fa-check">&nbsp;&nbsp;</i>Recommend</a><span>&nbsp; | &nbsp;</span><a'+jade.attr("href",l.authors[0].url,!0,!1)+jade.attr("data-has-card-for-user",l.authors[0].id,!0,!1)+' class="u-tcGray">'+jade.escape(null==(e=l.authors[0].display_name)?"":e)+"</a><script"+jade.attr("data-card-contents-for-user",l.authors[0].id,!0,!1)+' type="text/json">'+(null==(e=t.encodeHTML(s.stringify(l.authors[0])))?"":e)+"</script></div></li>")}else{var a=0;for(var r in n){a++;var u=n[r],l=u.get("work");i.push("<li"+jade.attr("id","certify_work_"+l.id,!0,!1)+' class="Panel-bodySegment u-p5x"><a'+jade.attr("href",l.internal_url,!0,!1)+" data-sidebar-truncate-to-lines='3' class=\"js-sidebar-truncate u-fw700 u-tcGrayDarker\">"+jade.escape(null==(e=l.title)?"":e)+'</a><div class="u-p1x"></div><div class="u-textTruncate u-tcGray"><a'+jade.attr("data-work-title",l.title,!0,!1)+jade.attr("data-work-id",l.id,!0,!1)+jade.attr("data-field-follower-count",u.get("potential_reach"),!0,!1)+' disabled="disabled" class="js-certification-button u-tcGreen u-fw700 u-clickable"><i class="fa fa-check">&nbsp;&nbsp;</i>Recommend</a><span>&nbsp; | &nbsp;</span><a'+jade.attr("href",l.authors[0].url,!0,!1)+jade.attr("data-has-card-for-user",l.authors[0].id,!0,!1)+' class="u-tcGray">'+jade.escape(null==(e=l.authors[0].display_name)?"":e)+"</a><script"+jade.attr("data-card-contents-for-user",l.authors[0].id,!0,!1)+' type="text/json">'+(null==(e=t.encodeHTML(s.stringify(l.authors[0])))?"":e)+"</script></div></li>")}}}.call(this),i.push("<li><a"+jade.attr("href",n.certifications_suggestions_path(),!0,!1)+" class=\"u-tcGrayDark\"><div class=\"Panel-footer u-p5x u-taCenter\"><span class=\"u-fw700\">View All</span></div></a></li></ul><script src=\"//cdn.rawgit.com/inorganik/countUp.js/v1.3.3/countUp.min.js\"></script><script type=\"text/javascript\">(function() {\n  req_and_ready('certifications');\n  $('.js-certification-button').on('click', showCertifyModal);\n  function showCertifyModal(evt) {\n    var $button = $(this),\n      workId = parseInt($button.data('work-id')),\n      params = {\n        workTitle: $button.data('work-title'),\n        workId: workId,\n        fieldFollowerCount: parseInt($button.data('field-follower-count')),\n        source: 'newsfeed_sidebar',\n        onCertify: function() {$('#certify_work_' + workId).fadeOut('slow')}\n      };\n    Components.Utils.showModal(Certifications.Modals.CertificationModal, params)\n  }\n})();</script>")}.call(this,"$h"in n?n.$h:"undefined"!=typeof $h?$h:undefined,"$r"in n?n.$r:"undefined"!=typeof $r?$r:undefined,"JSON"in n?n.JSON:"undefined"!=typeof JSON?JSON:undefined,"suggestions"in n?n.suggestions:"undefined"!=typeof suggestions?suggestions:undefined,"undefined"in n?n.undefined:undefined),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["sidebar_suggestions/templates/suggested_coauthor"]=function(t){var e,i=[],n=t||{};return function(t,n,s,o){i.push('<div class="Media"><div class="Media--left Media--middle">'),s=t.get("profile_picture_url"),o=t.get("affiliated_university"),void 0!==s&&null!==s&&o?i.push("<img"+jade.attr("src",s,!0,!1)+' class="avatar-md"/>'):i.push('<div class="avatar-md bg-gray-lighter u-taCenter valign-wrapper"><i class="fa fa-inverse fa-envelope-o fa-sm valign-item"></i></div>'),i.push('</div><div class="Media-body"><div style="width:200px" class="u-tcGrayDarker u-fw700 u-textTruncate">'+jade.escape(null==(e=t.get("name"))?"":e)+'</div><div style="width:200px" class="u-tcGrayDark u-pt1x u-textTruncate"><i class="fa fa-file-o"></i>&nbsp;&nbsp;'+jade.escape(null==(e=t.get("tags")[0].title)?"":e)+'</div></div></div><div class="js-expanded-content hidden"><div class="Media"><div class="Media--left Media--middle"><div class="avatar-md"></div></div><div class="Media-body u-mv2x u-tcGrayDark u-pt1x">'),void 0!==o&&null!==o?i.push('<i class="fa fa-university"></i>&nbsp;&nbsp;'+jade.escape(null==(e=o)?"":e)):(i.push('<i class="fa fa-envelope-o"></i>&nbsp;&nbsp;'),n=t.get("obfuscated_email"),void 0!==n&&null!==n?i.push(jade.escape(null==(e=n)?"":e)):i.push('<input class="js-coauthor-email"/>')),i.push('</div></div><div class="row u-m0x"><div class="col-xs-6 u-pr2x u-pl0x u-taCenter"><a class="js-coauthor-reject-coauthor Button Button--block Button--sm Button--inverseGray"><i class="fa fa-times"></i>&nbsp;&nbsp;Dismiss</a></div><div class="col-xs-6 u-pl2x u-pr0x u-taCenter"><a class="js-coauthor-accept-coauthor Button Button--block Button--sm Button--blue u-pl4x"><i class="fa fa-plus"></i>&nbsp;&nbsp;Confirm</a></div></div></div>')}.call(this,"coauthor"in n?n.coauthor:"undefined"!=typeof coauthor?coauthor:undefined,"email"in n?n.email:"undefined"!=typeof email?email:undefined,"photo"in n?n.photo:"undefined"!=typeof photo?photo:undefined,"university_name"in n?n.university_name:"undefined"!=typeof university_name?university_name:undefined),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["sidebar_suggestions/templates/suggested_coauthors"]=function(){var t=[];return t.push('<ul class="u-listStyleNone u-pl0x u-mb0x"></ul>'),t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["sidebar_suggestions/templates/suggested_discussion"]=function(t){var e,i=[],n=t||{};return function(t,n,s,o){var r=o.chair,a=t.build_url(o.url,[["source","sidebar"]]);i.push("<a"+jade.attr("href",a,!0,!1)+' class="u-fw700 u-tcGrayDarker u-wordBreakBreakAll js-suggested-discussion-name">'+jade.escape(null==(e=o.name)?"":e)+'</a><div class="discussion-suggestion-info u-mt1x"><a'+jade.attr("href",a,!0,!1)+' class="text-bold">Join</a><span class="u-tcGray"><span>&nbsp; | &nbsp;</span><a'+jade.attr("href",a,!0,!1)+' class="u-tcGray"><i class="fa fa-users u-pr2x"></i>'+jade.escape(null==(e=o.participant_count)?"":e)+"</a><span>&nbsp; | &nbsp;</span><a"+jade.attr("href",r.url,!0,!1)+jade.attr("data-has-card-for-user",r.id,!0,!1)+' class="u-tcGray">'+jade.escape(null==(e=r.display_name)?"":e)+"<script"+jade.attr("data-card-contents-for-user",r.id,!0,!1)+' type="text/json">'+(null==(e=n.encodeHTML(s.stringify(r)))?"":e)+"</script></a></span></div>")}.call(this,"$a"in n?n.$a:"undefined"!=typeof $a?$a:undefined,"$h"in n?n.$h:"undefined"!=typeof $h?$h:undefined,"JSON"in n?n.JSON:"undefined"!=typeof JSON?JSON:undefined,"suggestion"in n?n.suggestion:"undefined"!=typeof suggestion?suggestion:undefined),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["sidebar_suggestions/templates/suggested_discussions"]=function(){var t=[];return t.push('<!-- Required by SuggestionListView. TODO: Refactor suggestions code so--><!-- this template isn\'t needed.--><ul class="list-unstyled margin-bottom-0x"></ul>'),t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["sidebar_suggestions/templates/suggested_history"]=function(t){var e,i=[],n=t||{};return function(t,n,s,o){i.push('<ul class="u-listStyleNone u-pl0x u-mb0x">'),function(){var r=o;if("number"==typeof r.length)for(var a=0,u=r.length;a<u;a++){var l=r[a],c=l.get("work"),p=c.authors[0];i.push('<li class="Panel-bodySegment u-p5x"><a'+jade.attr("href",c.internal_url,!0,!1)+" data-sidebar-truncate-to-lines='2' class=\"js-sidebar-truncate u-fw700 u-tcGrayDarker\">"+jade.escape(null==(e=c.title)?"":e)+"</a><div><a"+jade.attr("href",p.url,!0,!1)+jade.attr("data-has-card-for-user",p.id,!0,!1)+' class="u-tcGrayDark u-displayInline">'+jade.escape(null==(e=p.display_name)?"":e)+"</a><script"+jade.attr("data-card-contents-for-user",p.id,!0,!1)+' type="text/json">'+(null==(e=t.encodeHTML(s.stringify(p)))?"":e)+'</script><div class="u-tcGrayLight js-sidebar-truncate u-displayInline">&nbsp; | &nbsp;'+jade.escape(null==(e=new n.User(p).affiliationString())?"":e)+"</div></div></li>")}else{var u=0;for(var a in r){u++;var l=r[a],c=l.get("work"),p=c.authors[0];i.push('<li class="Panel-bodySegment u-p5x"><a'+jade.attr("href",c.internal_url,!0,!1)+" data-sidebar-truncate-to-lines='2' class=\"js-sidebar-truncate u-fw700 u-tcGrayDarker\">"+jade.escape(null==(e=c.title)?"":e)+"</a><div><a"+jade.attr("href",p.url,!0,!1)+jade.attr("data-has-card-for-user",p.id,!0,!1)+' class="u-tcGrayDark u-displayInline">'+jade.escape(null==(e=p.display_name)?"":e)+"</a><script"+jade.attr("data-card-contents-for-user",p.id,!0,!1)+' type="text/json">'+(null==(e=t.encodeHTML(s.stringify(p)))?"":e)+'</script><div class="u-tcGrayLight js-sidebar-truncate u-displayInline">&nbsp; | &nbsp;'+jade.escape(null==(e=new n.User(p).affiliationString())?"":e)+"</div></div></li>")}}}.call(this),i.push('<li><a href="/ReadingHistory" class="u-tcGrayDark"><div class="Panel-footer u-p5x u-taCenter"><span class="u-fw700">View All</span></div></a></li></ul>')}.call(this,"$h"in n?n.$h:"undefined"!=typeof $h?$h:undefined,"Aedu"in n?n.Aedu:"undefined"!=typeof Aedu?Aedu:undefined,"JSON"in n?n.JSON:"undefined"!=typeof JSON?JSON:undefined,"suggestions"in n?n.suggestions:"undefined"!=typeof suggestions?suggestions:undefined,"undefined"in n?n.undefined:undefined),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["sidebar_suggestions/templates/suggested_interests"]=function(t){var e,i=[],n=t||{};return function(t,n){i.push('<ul class="u-listStyleNone u-pl0x u-mb0x">'),function(){var s=n;if("number"==typeof s.length)for(var o=0,r=s.length;o<r;o++){var a=s[o],u=a.get("interest");i.push("<li"+jade.attr("id","ri_suggestion_"+a.get("id"),!0,!1)+' class="followee-suggestion Panel-bodySegment u-p5x close-container"><div class="Media"><div'+jade.attr("data-ignore-suggested-ri-id",u.id,!0,!1)+' class="pull-right sidebar-close clickable"><a class="u-tcGrayLight u-textDecorationNone sidebar-close">&times;</a></div><div class="Media--middle Media--left"><a'+jade.attr("href",u.url,!0,!1)+' class="u-tcGrayDarker"><span class="u-fw700 js-sidebar-truncate">'+jade.escape(null==(e=u.name)?"":e)+'</span></a><div class="u-mt1x u-fs13"><a'+jade.attr("data-follow-ri-id",u.id,!0,!1)+' class="u-tcGreen u-fw700 clickable">Follow</a><span class="u-tcGray u-textTruncate u-displayInline">&nbsp; | &nbsp;'+jade.escape(null==(e=t.commaizeInt(u.follower_count))?"":e)+"&nbsp;Followers</span></div></div></div></li>")}else{var r=0;for(var o in s){r++;var a=s[o],u=a.get("interest");i.push("<li"+jade.attr("id","ri_suggestion_"+a.get("id"),!0,!1)+' class="followee-suggestion Panel-bodySegment u-p5x close-container"><div class="Media"><div'+jade.attr("data-ignore-suggested-ri-id",u.id,!0,!1)+' class="pull-right sidebar-close clickable"><a class="u-tcGrayLight u-textDecorationNone sidebar-close">&times;</a></div><div class="Media--middle Media--left"><a'+jade.attr("href",u.url,!0,!1)+' class="u-tcGrayDarker"><span class="u-fw700 js-sidebar-truncate">'+jade.escape(null==(e=u.name)?"":e)+'</span></a><div class="u-mt1x u-fs13"><a'+jade.attr("data-follow-ri-id",u.id,!0,!1)+' class="u-tcGreen u-fw700 clickable">Follow</a><span class="u-tcGray u-textTruncate u-displayInline">&nbsp; | &nbsp;'+jade.escape(null==(e=t.commaizeInt(u.follower_count))?"":e)+"&nbsp;Followers</span></div></div></div></li>")}}}.call(this),i.push("</ul>")}.call(this,"$h"in n?n.$h:"undefined"!=typeof $h?$h:undefined,"suggestions"in n?n.suggestions:"undefined"!=typeof suggestions?suggestions:undefined,"undefined"in n?n.undefined:undefined),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["sidebar_suggestions/templates/suggested_jobs"]=function(t){var e,i=[],n={},s=t||{};return function(t){n.media=e=function(t){this&&this.block,this&&this.attributes;i.push('<div class="u-mt0x"><a data-broccoli-component="job-title"'+jade.attr("href",t.url,!0,!1)+' class="u-tcGrayDarker u-fw700">'+jade.escape(null==(e=t.title)?"":e)+"</a></div>")},i.push('<ul class="u-listStyleNone u-pl0x u-mb0x">'),function(){var s=t;if("number"==typeof s.length)for(var o=0,r=s.length;o<r;o++){var a=s[o],u=a.get("job");i.push("<li"+jade.attr("id","job_"+u.id,!0,!1)+' class="followee-suggestion u-ph6x u-pb6x u-overflowWrapBreakWord close-container">'),n.media(u),u.universities.length>0?i.push('<div class="u-tcGrayDark u-fs12 u-lineHeight1_3 u-pv2x">'+jade.escape(null==(e=u.universities[0].name)?"":e)+"</div>"):i.push('<div class="u-tcGrayDark u-fs12 u-lineHeight1_3 u-pv2x">'+jade.escape(null==(e=u.location)?"":e)+"</div>"),i.push("</li>")}else{var r=0;for(var o in s){r++;var a=s[o],u=a.get("job");i.push("<li"+jade.attr("id","job_"+u.id,!0,!1)+' class="followee-suggestion u-ph6x u-pb6x u-overflowWrapBreakWord close-container">'),n.media(u),u.universities.length>0?i.push('<div class="u-tcGrayDark u-fs12 u-lineHeight1_3 u-pv2x">'+jade.escape(null==(e=u.universities[0].name)?"":e)+"</div>"):i.push('<div class="u-tcGrayDark u-fs12 u-lineHeight1_3 u-pv2x">'+jade.escape(null==(e=u.location)?"":e)+"</div>"),i.push("</li>")}}}.call(this),i.push("</ul>")}.call(this,"suggestions"in s?s.suggestions:"undefined"!=typeof suggestions?suggestions:undefined,"undefined"in s?s.undefined:undefined),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["sidebar_suggestions/templates/suggested_users"]=function(t){var e,i=[],n={},s=t||{};return function(t){n.media=e=function(t,n){this&&this.block,this&&this.attributes;i.push('<div class="media_v2 u-mt0x"><div class="media-left media-middle u-pr3x"><img'+jade.attr("src",n.photo,!0,!1)+' class="Avatar Avatar--sm"/></div><div class="media-body media-middle"><a'+jade.attr("href",n.url,!0,!1)+' style="width:190px" class="u-tcGrayDarker u-fw700 u-textTruncate">'+jade.escape(null==(e=n.display_name)?"":e)+'</a><ul class="InlineList InlineList--bordered"><li'+jade.attrs(jade.merge([{"class":"InlineList-item u-tcGreen u-fs13 u-lineHeight0 u-clickable"},t.followData()]),!1)+'><i class="fa fa-plus"></i>&nbsp;\nFollow</li><li'+jade.attr("data-ignore-suggested-user-id",n.id,!0,!1)+' data-broccoli-component="sidebar-user-ignore" class="InlineList-item u-tcGrayDark u-fs13 u-lineHeight0 u-clickable"><i class="fa fa-remove"></i>&nbsp;\nIgnore</li></ul></div></div>')},i.push('<ul class="u-listStyleNone u-pl0x u-mb0x">'),function(){var s=t;if("number"==typeof s.length)for(var o=0,r=s.length;o<r;o++){var a=s[o],u=a.get("user");i.push("<li"+jade.attr("id","user_suggestion_"+a.get("id"),!0,!1)+' class="followee-suggestion u-ph6x u-pb6x close-container">'),n.media(a,u),i.push("<span data-sidebar-truncate-to-lines='1' class=\"js-sidebar-truncate u-tcGrayDark u-fs12 u-lineHeight1_3 u-displayInlineBlock u-pv2x\">"+jade.escape(null==(e=u.affiliationString())?"":e)+'</span><br/><span class="u-tcGray u-fs11 u-lineHeight1_3 u-displayInlineBlock">'+(null==(e=a.reason({includeLinkedNames:!0}))?"":e)+"</span></li>")}else{var r=0;for(var o in s){r++;var a=s[o],u=a.get("user");i.push("<li"+jade.attr("id","user_suggestion_"+a.get("id"),!0,!1)+' class="followee-suggestion u-ph6x u-pb6x close-container">'),n.media(a,u),i.push("<span data-sidebar-truncate-to-lines='1' class=\"js-sidebar-truncate u-tcGrayDark u-fs12 u-lineHeight1_3 u-displayInlineBlock u-pv2x\">"+jade.escape(null==(e=u.affiliationString())?"":e)+'</span><br/><span class="u-tcGray u-fs11 u-lineHeight1_3 u-displayInlineBlock">'+(null==(e=a.reason({includeLinkedNames:!0}))?"":e)+"</span></li>")}}}.call(this),i.push("</ul>")}.call(this,"suggestions"in s?s.suggestions:"undefined"!=typeof suggestions?suggestions:undefined,"undefined"in s?s.undefined:undefined),i.join("")}}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestionListView=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(t){return i.__super__.initialize.apply(this,arguments),this.template=JST[t.template],this.suggestions=t.suggestions,this._renderOnSync(),this._rerenderOnRemoval(),this},i.prototype.render=function(){var t;return t=this.suggestions.displayable(4),t.length>0?(this.$el.html(this.template({suggestions:t})),this._truncate(),this._addHoverBehavior(t)):this.$el.html("<div class='u-ph6x u-mb6x u-tcGrayDark'>No results found.</div>")},i.prototype._truncate=function(){return this.$(".js-sidebar-truncate").each(function(){var t;return t=$(this),t.trunk8({lines:t.data("sidebar-truncate-to-lines"),tooltip:!0})})},i.prototype._addHoverBehavior=function(t){return _(t).each(function(t){return function(e){var i;if((i=t._suggestionElement(e))&&!i.data("expander"))return i.data("expander",new SidebarSuggestions.SuggestionExpander({el:i}))}}(this))},i.prototype._renderOnSync=function(){return this.listenTo(this.suggestions,"sync error",function(t){return function(){return t.render()}}(this))},i.prototype._rerenderOnRemoval=function(){return this.listenTo(this.suggestions,"remove",function(t){return function(e){var i,n;return i=t._suggestionElement(e),i&&(n=i.data("expander"))?n.collapse(function(){return t.render()}):t.render()}}(this))},i.prototype._suggestionElement=function(t){return this.$("*[data-suggestion-id="+t.get("id")+"]")},i}(Backbone.View)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.AffiliationModalController=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template="sidebar_suggestions/templates/suggested_affiliation",i.prototype.events={"click .js-news-sidebar-add-affiliation":"openEditor"},i.prototype.initialize=function(){var t;return t=$r.api_v0_suggestions_affiliation_path({subdomain_param:"api"}),$.get(t).done(function(t){return function(e){if(null!=e?e.department:void 0)return t.guessedAffiliation=t.getGuessedAffiliation(e),t.render()}}(this))},i.prototype.render=function(){var t,e;if(this.universityName())return t=JST[this.template]({guessText:"Are you at "+this.universityName()+"?"}),e=$(t).first(),this.$el.append(e),this.$modal=$(t).last(),$(document.body).append(this.$modal),this.postRender()},i.prototype.postRender=function(){return this.ui={$addAffiliationModal:this.$modal.find(".js-news-add-affiliation-modal"),$addAffiliationModalBody:this.$modal.find(".js-newsfeed-add-affiliation-modal-body")},this.$el.removeClass("hidden")},i.prototype._removeElement=function(){return this.$el.remove(),this.$modal.remove()},i.prototype.universityName=function(){var t,e;return null!=(t=this.guessedAffiliation.get("department"))&&null!=(e=t.university)?e.name:void 0},i.prototype.openEditor=function(){var t;return t=new AffiliationEditor.AffiliationEditView({cancelClass:"Button Button--inverseGray Button--lg Button--halfBlock",cancelAction:function(t){return function(){return t.ui.$addAffiliationModal.modal("hide"),Kale.notify({collectionName:"newsfeed",eventData:{event:"news_feed_affiliation_cancel"}})}}(this),saveClass:"Button Button--green Button--lg Button--halfBlock u-floatRight",saveAction:function(){return Kale.notify({collectionName:"newsfeed",eventData:{event:"news_feed_affiliation_save"}}),window.location.reload()},alwaysPrimary:!0,model:this.guessedAffiliation}),this.ui.$addAffiliationModalBody.append(t.el),this.ui.$addAffiliationModal.modal({show:!0,backdrop:!0,keyboard:!0}),this.ui.$addAffiliationModal.on("hide.bs.modal",function(){return t.remove()}),Kale.notify({collectionName:"newsfeed",eventData:{event:"news_feed_affiliation_open"}})},i.prototype.getGuessedAffiliation=function(t){var e,i,n,s;return n=new Backbone.Model(t),e=new Backbone.Model(Aedu.User.current.affiliation()),i=n.get("department"),i.university||(i=null),s=n.get("position")||this.nullPosition,e.set({department:i,position:s})},i.prototype.nullPosition={id:1},i}(Backbone.View)}.call(this),function(){SidebarSuggestions.CertificationSuggestions=function(){function t(t){this.suggestions=new SidebarSuggestions.SuggestedCertifications,this.suggestions.ensureMinDisplayable(8),this.view=new SidebarSuggestions.SuggestionListView({el:t.el,template:this.template,suggestions:this.suggestions}),this._listenForAccept()}return t.prototype.template="sidebar_suggestions/templates/suggested_certifications",t.prototype._listenForAccept=function(){return $(document).on("certification-created",function(t){return function(e,i){return t.suggestions.remove(t.suggestions.findWhere({id:i}))}}(this))},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.CoauthorSuggestionListView=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="ul",i.prototype.className="list-unstyled",i.prototype.render=function(){var t,e,i,n,s,o,r;for(0===this.$el.find("ul").length&&this.$el.html(this.template()),s=this.suggestions.displayable(4),o=[],e=0,i=s.length;e<i;e++)r=s[e],0===this.$el.find("[data-suggestion-id='"+r.cid+"']").length?(t=new SidebarSuggestions.CoauthorSuggestionView({model:r}),n=t.render().el,this.$el.find("ul").append(n),o.push($(n).data("expander",new SidebarSuggestions.SuggestionExpander({el:$(n)})))):o.push(void 0);return o},i}(SidebarSuggestions.SuggestionListView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.CoauthorSuggestionView=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template="sidebar_suggestions/templates/suggested_coauthor",i.prototype.tagName="li",i.prototype.className="coauthor-suggestion Panel-bodySegment u-p5x",i.prototype.attributes=function(){return{"data-suggestion-id":this.model.cid}},i.prototype.events={"click .js-coauthor-accept-coauthor":"acceptSuggestion","click .js-coauthor-reject-coauthor":"rejectSuggestion","click .js-coauthor-email":"coauthorEmailClicked"},i.prototype.render=function(){return this.$el.empty(),this.$el.append(JST[this.template]({coauthor:this.model})),this},i.prototype.acceptSuggestion=function(){var t;return t=this.model.saveSuggestion(!0),t.done(function(t){return function(){return t.remove()}}(this)),t.fail(function(t){return function(){return t.alertError()}}(this))},i.prototype.rejectSuggestion=function(){var t;return t=this.model.saveSuggestion(!1),t.done(function(t){return function(){return t.remove()}}(this)),t.fail(function(t){return function(){return t.alertError()}}(this))},i.prototype.coauthorEmailClicked=function(t){return t.stopPropagation()},i.prototype.alertError=function(){return alert("Oops! We encountered an error and failed to process your request.")},i.prototype.remove=function(){return i.__super__.remove.apply(this,arguments),this.model.collection.remove(this.model)},i}(Backbone.View)}.call(this),function(){SidebarSuggestions.CoauthorSuggestions=function(){function t(t){this.suggestions=new SidebarSuggestions.SuggestedCoauthors,this.suggestions.fetch(),this.view=new SidebarSuggestions.CoauthorSuggestionListView({el:t.el,template:this.template,suggestions:this.suggestions})}return t.prototype.template="sidebar_suggestions/templates/suggested_coauthors",t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.DiscussionSuggestionListView=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.tagName="ul",i.prototype.className="list-unstyled",i.prototype.initialize=function(t){return i.__super__.initialize.call(this,t)},i.prototype.render=function(){return i.__super__.render.apply(this,arguments),this.suggestions.each(function(t){return function(e){var i;return i=new SidebarSuggestions.DiscussionSuggestionView({model:e}),t.$el.find("ul").append(i.render().el),i.postRender()}}(this)),this},i}(SidebarSuggestions.SuggestionListView)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.DiscussionSuggestionView=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template="sidebar_suggestions/templates/suggested_discussion",i.prototype.tagName="li",i.prototype.className="discussion-suggestion Panel-bodySegment u-p5x",i.prototype.attributes=function(){return{"data-suggestion-id":this.model.get("id")}},i.prototype.render=function(){return this.$el.empty(),this.$el.append(JST[this.template]({suggestion:this.model.toJSON()})),this},i.prototype.postRender=function(){return this.$(".js-suggested-discussion-name").trunk8({lines:2,tooltip:!1})},i}(Backbone.View)}.call(this),function(){SidebarSuggestions.DiscussionSuggestions=function(){function t(t){this.suggestions=new SidebarSuggestions.SuggestedDiscussions,this.suggestions.ensureMinDisplayable(1),this.view=new SidebarSuggestions.DiscussionSuggestionListView({el:t.el,template:this.template,suggestions:this.suggestions})}return t.prototype.template="sidebar_suggestions/templates/suggested_discussions",t}()}.call(this),function(){SidebarSuggestions.HistorySuggestions=function(){function t(t){this.suggestions=new SidebarSuggestions.SuggestedHistorys,this.suggestions.ensureMinDisplayable(8),this.view=new SidebarSuggestions.SuggestionListView({el:t.el,template:this.template,suggestions:this.suggestions})}return t.prototype.template="sidebar_suggestions/templates/suggested_history",t}()}.call(this),function(){SidebarSuggestions.InterestSuggestions=function(){function t(t){this.suggestions=new SidebarSuggestions.SuggestedInterests,this.suggestions.ensureMinDisplayable(8),
this.view=new SidebarSuggestions.SuggestionListView({el:t.el,template:this.template,suggestions:this.suggestions}),this._listenForAcceptOrReject()}return t.prototype.template="sidebar_suggestions/templates/suggested_interests",t.prototype._listenForAcceptOrReject=function(){return this._loadTaggings(),$(document).on("click","*[data-follow-ri-id]",function(t){return function(e){var i;return i=$(e.currentTarget).data("follow-ri-id"),$("#ri_suggestion_"+i).fadeOut("slow",function(){return t.suggestions.removeById(i)}),t._loadTaggings(function(){return this.taggings.tag({id:i},null,{auto:suggestion.sourceString()}),Aedu.User.current.interests.push(suggestion.get("interest"))})}}(this)),$(document).on("click","*[data-unfollow-ri-id]",function(t){return function(e){var i;return i=$(e.currentTarget).data("unfollow-ri-id"),$("#ri_suggestion_"+i).fadeOut("slow",function(){return t.suggestions.removeById(i)}),t._loadTaggings(function(){return this.taggings.untag({id:i}),Aedu.User.current.interests=_.reject(Aedu.User.current.interests,function(t){return t.id===i})})}}(this)),$(document).on("click","*[data-ignore-suggested-ri-id]",function(t){return function(e){var i;return i=$(e.currentTarget).data("ignore-suggested-ri-id"),$("#ri_suggestion_"+i).fadeOut("slow",function(){var e;return null!=(e=t.suggestions.findWhere({id:i}))?e.destroy():void 0})}}(this))},t.prototype._loadTaggings=function(t){return req("new_profile",function(){return this.taggings||(this.taggings=new NewProfile.Taggings([],{tag_type:"ResearchInterest",target_type:"User",target_id:$current_user.id,tag_source:"sidebar_suggestion"})),"function"==typeof t?t():void 0})},t}()}.call(this),function(){SidebarSuggestions.JobSuggestions=function(){function t(t){this.suggestions=new SidebarSuggestions.SuggestedJobs,this.suggestions.ensureMinDisplayable(8),this.view=new SidebarSuggestions.SuggestionListView({el:t.el,template:this.template,suggestions:this.suggestions}),this.broccoliNotifier=new Aedu.Broccoli({defaultCollection:"ads"})}return t.prototype.template="sidebar_suggestions/templates/suggested_jobs",t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestionExpander=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(){return this.expanded=!1,i.__super__.initialize.apply(this,arguments),this.$expandedContent=this.$el.find(".js-expanded-content"),this},i.prototype.events={mouseenter:"expand",mouseleave:"collapse",click:"toggle"},i.prototype.expand=function(t){return this.expanded=!0,this.$expandedContent.removeClass("hidden").hide().slideDown(200,function(){return function(){return"function"==typeof t?t():void 0}}())},i.prototype.collapse=function(t){return this.expanded=!1,this.$expandedContent.slideUp(200,function(e){return function(){return e.$expandedContent.addClass("hidden"),"function"==typeof t?t():void 0}}(this))},i.prototype.toggle=function(){return this.expanded?this.collapse():this.expand()},i}(Backbone.View)}.call(this),function(){SidebarSuggestions.UserSuggestions=function(){function t(t){this.suggestions=new SidebarSuggestions.SuggestedUsers([],12),this.suggestions.ensureMinDisplayable(8),this.view=new SidebarSuggestions.SuggestionListView({el:t.el,template:this.template,suggestions:this.suggestions}),this.listenForAcceptOrReject()}return t.prototype.template="sidebar_suggestions/templates/suggested_users",t.prototype.listenForAcceptOrReject=function(){return $(document).on("click","*[data-follow-user-id]",function(t){return function(e){var i;return i=$(e.currentTarget).data("follow-user-id"),$("#user_suggestion_"+i).fadeOut("slow",function(){return t.suggestions.remove(t.suggestions.findWhere({id:i}))}),t.recordEvent("followed")}}(this)),$(document).on("click","*[data-unfollow-user-id]",function(t){return function(e){var i;return i=$(e.currentTarget).data("unfollow-user-id"),$("#user_suggestion_"+i).fadeOut("slow",function(){return t.suggestions.remove(t.suggestions.findWhere({id:i}))}),t.recordEvent("unfollowed")}}(this)),$(document).on("click","*[data-ignore-suggested-user-id]",function(t){return function(e){var i;return i=$(e.currentTarget).data("ignore-suggested-user-id"),$("#user_suggestion_"+i).fadeOut("slow",function(){var e;return null!=(e=t.suggestions.findWhere({id:i}))?e.destroy():void 0}),t.recordEvent("ignored")}}(this))},t.prototype.recordEvent=function(t){return Kale.notify({collectionName:"newsfeed",eventData:{event:"user_suggestion_"+t}})},t}()}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestedCoauthors=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.model=SidebarSuggestions.SuggestedCoauthor,i.prototype.url=$r.api_v0_suggestions_coauthors_path({subdomain_param:"api"}),i.prototype.parse=function(t){return t},i.prototype.displayable=function(t){return this.slice(this.length-t,this.length)},i}(SidebarSuggestions.SuggestionsCollection)}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;SidebarSuggestions.SuggestedJobs=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.model=SidebarSuggestions.SuggestedJob,i.prototype.url=$r.randomized_last_api_v0_suggestions_jobs_path({subdomain_param:"api"}),i.prototype.parse=function(t){return null==(null!=t?t.jobs:void 0)?[]:_(t.jobs).map(function(t){return new SidebarSuggestions.SuggestedJob({job:t})})},i.prototype.displayable=function(){return this.filter(function(){return!0})},i}(SidebarSuggestions.SuggestionsCollection)}.call(this);
//# sourceMappingURL=https://academia.edu/assets/maps/single_work-988249cfb69bbe132ef34d9fe4c583e845a7b3b2c5c8ae0688fd545eff8e42d5.js.map
