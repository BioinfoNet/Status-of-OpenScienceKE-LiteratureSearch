
We use cookies to enhance your experience on our website.By continuing to use our website, you are agreeing to our use of cookies. You can change your cookie settings at any time. Find out more Skip to Main Content
Oxford University Press

    Search
    Account Menu
    Menu
    Sign In
    Register

Navbar Search Filter This issue All Bioinformatics All Journals Mobile Microsite Search Term

    Sign In
    Register

    Issues
    Advance articles
    Submit
        Author Guidelines
        Submission Site
        Open Access
    Purchase
    Alerts
    About
        About Bioinformatics
        Journals Career Network
        Editorial Board
        Advertising and Corporate Services
        Self-Archiving Policy
        Dispatch Dates

Bioinformatics
International Society for Computational Biology

    Issues
    Advance articles
    Submit
        Author Guidelines
        Submission Site
        Open Access
    Purchase
    Alerts
    About
        About Bioinformatics
        Journals Career Network
        Editorial Board
        Advertising and Corporate Services
        Self-Archiving Policy
        Dispatch Dates

Close
search filter This issue All Bioinformatics All Journals search input
Advanced Search
Article Navigation
Close mobile search navigation
Article Navigation
Issue Cover
Volume 26
Issue 3
1 February 2010
Article Contents

    Abstract
    ACKNOWLEDGEMENTS
    REFERENCES
    Author notes

    < Previous
    Next >

Article Navigation
pegas: an R package for population genetics with an integrated–modular approach
Emmanuel Paradis
Institut de Recherche pour le Développement, UR175 CAVIAR, BP 5095, 361 rue Jean-François Breton, F-34196 Montpellier Cédex 5, France
Search for other works by this author on:
Oxford Academic
PubMed
Google Scholar
Emmanuel Paradis
Associate Editor: Jeffrey Barrett
Author Notes
Bioinformatics , Volume 26, Issue 3, 1 February 2010, Pages 419–420, https://doi.org/10.1093/bioinformatics/btp696
Published:
01 February 2010
Article history
Received:
07 October 2009
Revision received:
14 December 2009
Accepted:
16 December 2009
Published:
01 February 2010

    pdf PDF
    Split View
    Views
        Article contents
        Figures & tables
    Cite
    Citation

    Emmanuel Paradis, pegas: an R package for population genetics with an integrated–modular approach, Bioinformatics , Volume 26, Issue 3, 1 February 2010, Pages 419–420, https://doi.org/10.1093/bioinformatics/btp696

    Download citation file:
        Ris (Zotero)
        EndNote
        BibTex
        Medlars
        ProCite
        RefWorks
        Reference Manager

    © 2019 Oxford University Press
    Close
    Permissions Icon Permissions
    Share
        Email
        Twitter
        Facebook
        More

Navbar Search Filter This issue All Bioinformatics All Journals Mobile Microsite Search Term

    Sign In
    Register

Close
search filter This issue All Bioinformatics All Journals search input
Advanced Search
Abstract

Summary: pegas (Population and Evolutionary Genetics Analysis System) is a new package for the analysis of population genetic data. It is written in R and is integrated with two other existing R packages (ape and adegenet). pegas provides functions for standard population genetic methods, as well as low-level functions for developing new methods. The flexible and efficient graphical capabilities of R are used for plotting haplotype networks as well as for other functionalities. pegas emphasizes the need to further develop an integrated–modular approach for software dedicated to the analysis of population genetic data.

Availability: pegas is distributed through the Comprehensive R Archive Network (CRAN): http://cran.r-project.org/web/packages/pegas/index.html Further information may be found at: http://ape.mpl.ird.fr/pegas/

Contact: emmanuel.paradis@ird.fr

Population genetics has a strong mathematical background, and therefore genetic data analyses heavily relies on computer programs. Currently, no unified framework for these programs exists making the use of the many different population genetics programs a complicated task (Excoffier and Heckel, 2006 ). On the other hand, R (R Development Core Team, 2009 ) appeared as a unified framework for analysing data in bioinformatics (Gentleman, 2008 ) and phylogenetics (Paradis, 2006 ). In this note, I introduce pegas (Population and Evolutionary Genetics Analysis System) which aims to fill the gap between the existing R packages and the current need in population genetic data analyses.

pegas is entirely written in R to insure maximum portability among operating systems. It requires a standard R installation as well as two packages: ape (Paradis et al. , 2004 ) and adegenet (Jombart, 2008 ). These three packages make an integrated environment for population genetic data analysis.

One of the strengths of R is the flexibility of its data structures, so that it is easy to adapt them for a particular field, resulting in much easier data input/output and manipulation (one of the most time-consuming step in data analysis). Two such structures have been derived for pegas . The main one is the class ‘loci’ which is a simple data frame where the rows are individuals and the columns are loci and optional variables. The latter may be of any kind (continuous, integer, logical, etc.). Loci are coded with R factors (i.e. categorical variables) which are vectors of integers. Since computing on integers is fast, counting genotypic frequencies can be done efficiently. The convention is to code a genotype with the alleles separated with a forward slash, so that once genotypes are counted, allelic frequencies are easily obtained by counting the number of alleles in each genotype. Consequently, any level of ploidy may be handled. Since most operations on allelic data require counting allele and genotype frequencies, this operation has been optimized in the function summary.loci which is used by other functions in pegas .

The class ‘loci’ inherits the class ‘data.frame’ (a standard class in R) so all functionalities available for the latter (manipulation, subsetting, etc.) can be used for the former (Chambers, 2008 ). The typical example is in the use of the indexing operator [, ] . A special version of this operator has been written for the class ‘loci’ so that the loci columns are correctly identified even after deletion of some rows and/or columns. Another advantage of the data frame structure is that each row is identified by a unique label (the rownames ) so that these data may easily be matched with other data that have similar labels (e.g. a distance matrix, a DNA sequence alignment or a genealogy).

R has many tools to analyse data frames and these may be used directly for the class ‘loci’ and functions in pegas . A common task in population genetics is to perform some analyses for different subsets of the data (populations, breeds, plots, etc.). For instance, if a data set x has a variable population , the R function by may be used to compute some statistics for each level of this variable, e.g. by(x, x$population, hw.test) to perform Hardy–Weinberg test. The second argument may be a list of variables in which case the analyses will be done for each combination of them, e.g. by(x, list(x$plot, x$treatment), summary) will compute allele and genotype frequencies for every combination of plot and treatment .

The second main special data structure of pegas is the class ‘haplotype’ which inherits the class ‘DNAbin’ of ape . In addition to the set of unique DNA sequences, this class includes a vector of indices identifying the individuals belonging to each haplotype. This makes possible to link a set of haplotypes with individual data (phenotypes, geographic locations, etc.).

Missing data are coded explicitly in pegas . In the class ‘loci’ , the standard NA is used and these are handled in the R standard way. In the class ‘haplotype’ , the IUPAC code for ambiguous nucleotides is used and this is taken into account during calculations.

The current version of pegas includes standard tools for population genetic analyses: genotypic and allelic frequencies, Hardy–Weinberg equilibrium, F ST , analysis of molecular variance, haplotype network, mismatch distribution, Tajima's D and R 2 tests for population stability, nucleotide diversity (π), the population parameter θ (=4 N e ν), the site frequency spectrum, as well as several functions for reading and writing data files. pegas has also several low-level functions for manipulating its data structures (extracting observed alleled and genotypes, their frequencies, ploidy levels, building tables of all possible genotypes), making possible to extend its functionalities in a straightforward way. pegas includes basic tools for the coalescent such a computing likelihoods for a given tree, and estimating θ by maximum likelihood. All functions are accompanied with a help page describing how the calculations are done and giving the relevant literature references. These pages are compiled in a reference manual in PDF available from the above web site.

There are already a large number of computer programs for handling genetic data, so it is crucial for R users to be able to analyse the data files from the most widely used ones. pegas provides a function read.loci to read allelic data in tabular form from a text file. This function has several options to specify the loci and allele separator as well as which columns should be considered as loci or as additional variables. pegas has several functions to convert the data structures from adegenet (class ‘genind’ ) to the class ‘loci’ . Since adegenet has functions to read files created for the programs STRUCTURE, FSTAT, GENETIX and GENEPOP ( read.structure , read.fstat , read.genetix , read.genepop ), these file formats may also be readily used into pegas as well. Once read into R, and possibly converted into the class ‘loci’ , data can be edited by hand with the R spreadsheet data editor ( Fig. 1 ). pegas is distributed with a tutorial explaining, step-by-step, how to input data from different file formats (in R type vignette(‘ReadingFiles’) ).
Fig. 1.
The R data editor showing microsatellite data. Note the first column allowing to edit the individual (row) labels.
Open in new tab Download slide

The R data editor showing microsatellite data. Note the first column allowing to edit the individual (row) labels.
Fig. 1.
The R data editor showing microsatellite data. Note the first column allowing to edit the individual (row) labels.
Open in new tab Download slide

The R data editor showing microsatellite data. Note the first column allowing to edit the individual (row) labels.

pegas uses the efficient and flexible graphical capabilities of R (Murrell, 2006 ). For instance, the options for plotting a haplotype network (Templeton et al. , 1992 ) are:

graphic

These options make possible to plot symbols of different sizes, colours (contour and background) and the links between them may be of different colours, widths or line types (solid, dotted, dashed, etc.). These may be controlled by variables computed from the original dataset with R's standard statistical and computing tools.

pegas illustrates the use of an integrated–modular approach for the development of software data analysis. The three packages adegenet , ape and pegas , complement each other for population genetics as they provide functions for spatial and multivariate analyses ( adegenet ), trees structures and DNA sequences manipulation ( ape ) and basic population genetic analyses ( pegas ). Furthermore, each package has enough functionalities to be used on its own, independently of the others.
ACKNOWLEDGEMENTS

I am grateful to two anonymous referees for their comments on a previous version of this article and to Thibaut Jombart for useful discussions.

Funding : IRD program ‘Spirales’, and European Science Foundation (ESF) through the MolArch (Molecular Archives of Past Climatic Changes) project.

Conflict of Interest : none declared.
REFERENCES
Chambers
JM
. 
, 
Software for Data Analysis: Programming with R
 , 
2008
New York
Springer
Google Preview
WorldCat
COPAC
 
Excoffier
L
, 
Heckel
G
. 
Computer programs for population genetics data analysis: a survival guide
, 
Nat. Rev. Genet.
 , 
2006
, vol. 
7
 (pg. 
745
-
758
)
Google Scholar
Crossref
Search ADS
PubMed
WorldCat
 
Gentleman
R
. 
, 
R Programming for Bioinformatics.
 , 
2008
Boca Raton
Chapman & Hall/CRC
Google Preview
WorldCat
COPAC
 
Jombart
T
. 
adegenet: a R package for the multivariate analysis of genetic markers
, 
Bioinformatics
 , 
2008
, vol. 
24
 (pg. 
1403
-
1405
)
Google Scholar
Crossref
Search ADS
PubMed
WorldCat
 
Murrell
P
. 
, 
R Graphics.
 , 
2006
Boca Raton, FL
Chapman & Hall/CRC
Google Preview
WorldCat
COPAC
 
Paradis
E
. 
, 
Analysis of Phylogenetics and Evolution with R
 , 
2006
New York
Springer
Google Preview
WorldCat
COPAC
 
Paradis
E
, et al. 
APE: analyses of phylogenetics and evolution in R language
, 
Bioinformatics
 , 
2004
, vol. 
20
 (pg. 
289
-
290
)
Google Scholar
Crossref
Search ADS
PubMed
WorldCat
 
R Development Core Team
R: A Language and Environment for Statistical Computing
, 
R Foundation for Statistical Computing
 , 
2009
Vienna, Austria
WorldCat
COPAC
 
Templeton
AR
, et al. 
A cladistic analysis of phenotypic association with haplotypes inferred from restriction endonuclease mapping and DNA sequence data. III. Cladogram estimation
, 
Genetics
 , 
1992
, vol. 
132
 (pg. 
619
-
635
)
Google Scholar
PubMed
WorldCat
 
Author notes
Associate Editor: Jeffrey Barrett
© The Author 2009. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org
Issue Section:
GENETICS AND POPULATION ANALYSIS
Download all figures
7,076 Views
572 Citations
Article has an altmetric score of 1
View Metrics
×
Email alerts
New issue alert
Advance article alerts
Article activity alert
Receive exclusive offers and updates from Oxford Academic
Close
Related articles in

    Web of Science
    Google Scholar

Citing articles via
Web of Science (572)
Google Scholar
Crossref

    Latest
    Most Read
    Most Cited

Accurate detection of short and long active ORFs using Ribo-seq data
All-FIT: Allele-Frequency-based Imputation of Tumor Purity from High-Depth Sequencing Data
Distance Measures for Tumor Evolutionary Trees
Fuzzy modeling and global optimization to predict novel therapeutic targets in cancer cells
Easy-HLA, a validated web application suite to reveal the full details of HLA typing
Looking for your next opportunity?
Specialist Cardiologist - echocardiography
Hamilton, Other / Non US
Specialist Orthopaedic Surgeon - Subspecialty spines
Hamilton, Other / Non US
Assistant Clinical Investigator
Bethesda, Maryland
Assistant Clinical Investigator
bethesda, Maryland
View all jobs
OXFORD University Press
Journals Career Network

    About Bioinformatics
    Editorial Board
    Author Guidelines
    Facebook
    Twitter

    Purchase
    Recommend to your Library
    Advertising and Corporate Services
    Journals Career Network

Bioinformatics

    Online ISSN 1460-2059
    Print ISSN 1367-4803
    Copyright © 2019 Oxford University Press

    About Us
    Contact Us
    Careers
    Help
    Access & Purchase
    Rights & Permissions
    Open Access

Connect

    Join Our Mailing List
    OUPblog
    Twitter
    Facebook
    YouTube
    Tumblr

Resources

    Authors
    Librarians
    Societies
    Sponsors & Advertisers
    Press & Media
    Agents

Explore

    Shop OUP Academic
    Oxford Dictionaries
    Oxford Index
    Epigeum
    OUP Worldwide
    University of Oxford

Oxford University Press is a department of the University of Oxford. It furthers the University's objective of excellence in research, scholarship, and education by publishing worldwide
Oxford University Press

    Copyright © 2019 Oxford University Press
    Cookie Policy
    Privacy Policy
    Legal Notice
    Site Map
    Accessibility
    Get Adobe Reader

Close
This Feature Is Available To Subscribers Only

Sign In or Create an Account
Close

This PDF is available to Subscribers Only
View Article Abstract & Purchase Options

For full access to this pdf, sign in to an existing account, or purchase an annual subscription.
Close
Scholarly IQ
